(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[77],{"6eeR":function(e,t,a){"use strict";a.r(t);a("IzEo");var n=a("bx4M"),r=(a("qVdP"),a("jsC+")),l=a("0Owb"),c=(a("+L6B"),a("2/Rp")),s=(a("iQDF"),a("+eQT")),i=(a("14J3"),a("BMrR")),o=(a("jCWc"),a("kPKH")),u=(a("5NDa"),a("5rEg")),m=(a("2qtc"),a("kLXV")),d=(a("lUTK"),a("BvKs")),p=a("k1fw"),b=(a("y8nQ"),a("Vl3Y")),E=a("tJVT"),f=(a("/xke"),a("TeRw")),k=(a("OaEy"),a("2fM7")),y=a("q1tI"),g=a.n(y),h=a("Hx5s"),O=a("FRQA"),j=(a("T2oS"),a("W9HT")),v=(a("DZo9"),a("8z0m")),w=(a("miYZ"),a("tsqr")),I=a("z7Xi"),x=a("MuoO"),S=a("9xjH"),C=a.n(S),T=a("+n12"),R=a("wd/R"),D=a.n(R),N=k["a"].Option,B=function(e,t,a,n,r){f["default"][e||"info"]({top:165,message:t,description:a,placement:n,duration:r||3})},L=function(e){var t=e.closeModal,a=e.riskRecordId,n=e.isEdit,r=e.dispatch,m=e.loading,d=e.loading3,f=e.loading4,h=e.upDataParentData,O=e.askType,x=[{type:1,text:"C1"},{type:2,text:"C2"},{type:3,text:"C3"},{type:4,text:"C4"},{type:5,text:"C5"}],S=b["a"].useForm(),R=Object(E["a"])(S,1),L=R[0],A={labelCol:{span:8},wrapperCol:{span:16}},U=Object(y["useState"])([]),q=Object(E["a"])(U,2),F=q[0],M=q[1],Q=Object(y["useState"])({}),Y=Object(E["a"])(Q,2),z=Y[0],H=Y[1],J=Object(y["useState"])([]),V=Object(E["a"])(J,2),G=V[0],P=V[1],K=Object(y["useState"])(""),_=Object(E["a"])(K,2),W=_[0],X=_[1],Z=Object(y["useState"])([]),$=Object(E["a"])(Z,2),ee=$[0],te=$[1],ae=Object(y["useState"])(0),ne=Object(E["a"])(ae,2),re=ne[0],le=ne[1],ce=Object(y["useState"])([]),se=Object(E["a"])(ce,2),ie=se[0],oe=se[1],ue=Object(y["useState"])([]),me=Object(E["a"])(ue,2),de=me[0],pe=me[1],be=function(e){console.log(z),r({type:"risk/editRiskQuestionnaire",payload:Object(p["a"])(Object(p["a"])({},e),{},{riskRecordId:a,attachmentsId:W,usableStatus:1,isUseSeal:z.isUseSeal}),callback:function(e){1008===e.code?(t(!1),h()):w["default"].error(e.message)}})},Ee=function(e){window.open(e.url)},fe=function(e){M(e.fileList);var t=e.file;"removed"===t.status&&r({type:"risk/deleteFile",payload:{attachmentsId:W},callback:function(e){1008===e.code?(X(""),B("success","\u63d0\u9192","\u5220\u9664\u6210\u529f")):B("error","\u63d0\u9192","\u5220\u9664\u5931\u8d25")}}),"uploading"!==t.status&&"removed"!==t.status&&"done"===t.status&&(1008===t.response.code?(B("success","\u63d0\u9192","\u4e0a\u4f20\u6210\u529f"),M([{uid:t.response.data.attachmentsId,status:"done",name:t.response.data.fileName,url:"".concat(t.response.data.baseUrl)}]),X(t.response.data.attachmentsId)):(M(e.fileList.slice(0,1)),B("warning","\u63d0\u9192","\u4e0a\u4f20\u5931\u8d25")))};Object(y["useEffect"])((function(){r({type:"risk/getAllCustomerArr",callback:function(e){P(e)}}),O?(O=3===O?2:O,r({type:"risk/queryRiskLevel",payload:{askType:O},callback:function(e){te(e)}})):te(x)}),[]);var ke=function(e,t){var a=[];Array.isArray(e)&&e.forEach((function(e){e.riskText==="C".concat(t)&&Array.isArray(e.starList)&&e.starList.forEach((function(e){a.push({label:e.starLevel,value:e.starLevel})}))})),oe(a)};Object(y["useEffect"])((function(){n&&r({type:"risk/detailRiskQuestionnaire",payload:{riskRecordId:a},callback:function(e){if(e.attachment&&M([{uid:e.attachment&&e.attachment.attachmentsId,status:"done",name:e.attachment&&e.attachment.fileName,url:e.attachment&&e.attachment.signUrl||e.attachment.baseUrl,fileUrl:e.attachment&&e.attachment.signUrl||e.attachment.baseUrl}]),le(e.riskType),Object(T["v"])(e.abilityJson)){var t=JSON.parse(e.abilityJson);pe(t)}X(e.attachmentsId),H(e),L.setFieldsValue(Object(p["a"])(Object(p["a"])({},e),{},{riskDate:e.riskDate?D()(e.riskDate):null,riskLimitDate:e.riskLimitDate?D()(e.riskLimitDate):null}))}})}),[]);var ye=function(e){le(e)};return Object(y["useEffect"])((function(){ke(de,re)}),[de,re]),g.a.createElement(j["a"],{spinning:Boolean(m)||Boolean(d)||Boolean(f)},g.a.createElement("div",{className:C.a.box},g.a.createElement(b["a"],Object(l["a"])({form:L},A,{onFinish:be}),g.a.createElement(i["a"],{gutter:24,style:{width:"100%"}},g.a.createElement(o["a"],{span:8},g.a.createElement(b["a"].Item,{name:"customerId",label:"\u5ba2\u6237\u540d\u79f0",rules:[{required:!0,message:"\u5ba2\u6237\u540d\u79f0\u5fc5\u586b"}]},g.a.createElement(k["a"],{allowClear:!0,disabled:!0,placeholder:"\u8bf7\u9009\u62e9",showSearch:!0,filterOption:function(e,t){return t.children.indexOf(e)>=0}},G.map((function(e){return g.a.createElement(N,{key:e.customerId,value:e.customerId},e.customerName)}))))),g.a.createElement(o["a"],{span:8},g.a.createElement(b["a"].Item,{name:"riskType",label:"\u98ce\u9669\u7b49\u7ea7",rules:[{required:!0,message:"\u98ce\u9669\u7b49\u7ea7\u5fc5\u586b"}]},g.a.createElement(k["a"],{placeholder:"\u8bf7\u9009\u62e9",allowClear:!0,onChange:ye},ee.map((function(e,t){return g.a.createElement(N,{value:+e.type,key:e.type},e.text||"--")}))))),g.a.createElement(o["a"],{span:8},g.a.createElement(b["a"].Item,{name:"score",label:"\u98ce\u9669\u6d4b\u8bc4\u5206\u503c"},g.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165"})))),g.a.createElement(i["a"],{gutter:24,style:{width:"100%"}},g.a.createElement(o["a"],{span:8},g.a.createElement(b["a"].Item,{name:"riskDate",label:"\u5b8c\u6210\u65f6\u95f4"},g.a.createElement(s["a"],{style:{width:"100%"}}))),g.a.createElement(o["a"],{span:8},g.a.createElement(b["a"].Item,{name:"riskLimitDate",label:"\u95ee\u5377\u5230\u671f\u65f6\u95f4"},g.a.createElement(s["a"],{style:{width:"100%"}}))),g.a.createElement(o["a"],{span:8},g.a.createElement(b["a"].Item,{name:"sourceType",label:"\u95ee\u5377\u6765\u6e90",initialValue:2},g.a.createElement(k["a"],{placeholder:"\u8bf7\u9009\u62e9",disabled:!0,allowClear:!0},g.a.createElement(N,{value:1},"\u7ebf\u4e0a\u586b\u5199"),g.a.createElement(N,{value:2},"\u540e\u53f0\u521b\u5efa"),g.a.createElement(N,{value:3},"\u7535\u5b50\u5408\u540c\u7b7e\u7ea6"),g.a.createElement(N,{value:4},"\u975e\u7535\u5b50\u5408\u540c\u7b7e\u7ea6"))))),g.a.createElement(i["a"],{gutter:24,style:{width:"100%"}},g.a.createElement(o["a"],{span:8},g.a.createElement(b["a"].Item,{label:"\u661f\u7ea7",name:"riskStarRating"},g.a.createElement(k["a"],{placeholder:"\u8bf7\u9009\u62e9",allowClear:!0},ie.map((function(e){return g.a.createElement(k["a"].Option,{key:e.value,value:e.value}," ",e.label)}))))),g.a.createElement(o["a"],{span:16,style:{display:"flex"}},g.a.createElement("span",{style:{paddingLeft:26,paddingTop:6}},"\u6d4b\u8bc4\u95ee\u5377\uff1a"),g.a.createElement("div",{className:C.a.uploadBox},g.a.createElement(v["a"],{name:"file",action:"".concat({baseUrl:"/sitvipmanager/",adminUrl:"/vip-manager",ASSSET_DOMIAN:"RESOURCE_PATH",AI:{AI_type:2},isSaas:2}.adminUrl,"/attachments/uploadFile"),headers:{tokenId:Object(T["l"])("vipAdminToken")},fileList:F,data:{source:4,codeType:107},onPreview:Ee,onChange:fe},g.a.createElement(c["a"],{icon:g.a.createElement(I["a"],null)},"\u70b9\u51fb\u4e0a\u4f20"))))),g.a.createElement("div",{className:C.a.btnG},g.a.createElement(c["a"],{htmlType:"submit",type:"primary",className:C.a.subBtn},"\u786e\u5b9a"),g.a.createElement(c["a"],{onClick:function(e){return t(!1)}},"\u53d6\u6d88")))))},A=Object(x["connect"])((function(e){var t=e.risk,a=e.loading;return{risk:t,loading:a.effects["risk/detailRiskQuestionnaire"],loading2:a.effects["risk/queryRiskList"],loading3:a.effects["risk/createNewRiskQuestionnaire"],loading4:a.effects["risk/editRiskQuestionnaire"]}}))(L),U=a("tQHx"),q=a("d6hm"),F=a.n(q),M=k["a"].Option,Q=function(e,t,a,n,r){f["default"][e||"info"]({message:t,description:a,placement:n,duration:r||3})},Y=function(e){var t={labelCol:{span:8},wrapperCol:{span:16}},a={pageNum:1,pageSize:20},f=Object(T["o"])(50100),j=f.authEdit,v=f.authExport,w=b["a"].useForm(),I=Object(E["a"])(w,1),x=I[0],S=Object(y["useState"])(a),C=Object(E["a"])(S,2),R=C[0],N=C[1],B=Object(y["useState"])(!1),L=Object(E["a"])(B,2),q=L[0],Y=L[1],z=Object(y["useState"])({}),H=Object(E["a"])(z,2),J=H[0],V=H[1],G=Object(y["useState"])({}),P=Object(E["a"])(G,2),K=P[0],_=P[1],W=Object(y["useState"])([]),X=Object(E["a"])(W,2),Z=X[0],$=X[1],ee=Object(y["useCallback"])(Y,[]),te=Object(y["useState"])({}),ae=Object(E["a"])(te,2),ne=ae[0],re=ae[1],le=Object(y["useState"])(!1),ce=Object(E["a"])(le,2),se=ce[0],ie=ce[1],oe=Object(y["useState"])(!1),ue=Object(E["a"])(oe,2),me=ue[0],de=ue[1],pe=Object(y["useState"])(""),be=Object(E["a"])(pe,2),Ee=be[0],fe=be[1],ke=Object(y["useState"])([]),ye=Object(E["a"])(ke,2),ge=ye[0],he=ye[1],Oe=function(e){N(Object(p["a"])(Object(p["a"])({},R),{},{pageNum:e.current,pageSize:e.pageSize}))},je=function(e){if(e instanceof Array){if(!e.length)return;e=e.join(",")}de(!0),Object(T["d"])("/riskRecord/download",{riskRecordIds:e}).then((function(){de(!1)}))},ve=function(e){$(e)},we={selectedRowKeys:Z,onChange:ve},Ie=function(){x.resetFields(),V({}),N(Object(p["a"])(Object(p["a"])({},R),{},{pageNum:1}))},xe=function(e){var t,a=e.riskType&&e.riskType.split("-"),n=Object(p["a"])(Object(p["a"])({},e),{},{riskLimitDate:null===(t=e.riskLimitDate)||void 0===t?void 0:t.format("x"),askType:a&&a[0],riskType:a&&a[1]});V(n),N(Object(p["a"])(Object(p["a"])({},R),{},{pageNum:1}))},Se=function(e){fe(e.askType),ie(!0),re(e.riskRecordId),Y(!0)},Ce=function(){var t=e.dispatch;t({type:"risk/queryRiskList",payload:Object(p["a"])(Object(p["a"])({},J),R),callback:function(e){_(e)}})},Te=[{title:"\u5ba2\u6237\u540d\u79f0",dataIndex:"customerName",align:"center",width:200,fixed:"left",render:function(e){return e||"--"}},{title:"\u8bc1\u4ef6\u53f7\u7801",dataIndex:"cardNumber",width:120,render:function(e){return e||"--"}},{title:"\u5ba2\u6237\u7c7b\u578b",dataIndex:"customerType",align:"center",width:100,render:function(e){return 1===e?"\u4e2a\u4eba":2===e?"\u673a\u6784":3===e?"\u4ea7\u54c1":"--"}},{title:"\u6295\u8d44\u8005\u5206\u503c",dataIndex:"score",align:"center",width:100,render:function(e){return e||"--"}},{title:"\u98ce\u9669\u7b49\u7ea7",dataIndex:"riskType",align:"center",width:100,render:function(e){return e||"--"}},{title:"\u95ee\u5377\u7248\u672c",dataIndex:"versionNumber",align:"center",width:100,render:function(e){return e||"--"}},{title:"\u661f\u7ea7",dataIndex:"riskStarRating",width:100,render:function(e){return g.a.createElement("span",null,e||"--")}},{title:"\u95ee\u5377\u6709\u6548\u6027",dataIndex:"usableStatus",align:"center",width:100,render:function(e){return 0===e?"\u6709\u6548":1===e?"\u65e0\u6548":"--"}},{title:"\u5b8c\u6210\u65f6\u95f4",dataIndex:"riskDate",align:"center",render:function(e){return e?D()(e).format("YYYY-MM-DD"):"--"},sorter:function(e,t){return e.riskDate-t.riskDate},width:100},{title:"\u95ee\u5377\u5230\u671f\u65f6\u95f4",dataIndex:"riskLimitDate",align:"center",render:function(e){return e?D()(e).format("YYYY-MM-DD"):"--"},sorter:function(e,t){return e.riskLimitDate-t.riskLimitDate},width:130},{title:"\u95ee\u5377\u7528\u5370\u72b6\u6001",dataIndex:"isUseSeal",align:"center",width:110,render:function(e){return 0===e?"\u6ca1\u6709\u7528\u5370":1===e?"\u5df2\u7528\u5370":"--"}},{title:"\u95ee\u5377\u6765\u6e90",dataIndex:"sourceType",align:"center",width:100,render:function(e){return 1===e?"\u7ebf\u4e0a\u586b\u5199":2===e?"\u540e\u53f0\u521b\u5efa":3===e?"\u7535\u5b50\u5408\u540c\u7b7e\u7ea6":4===e?"\u975e\u7535\u5b50\u5408\u540c\u7b7e\u7ea6":"--"}},{title:"\u64cd\u4f5c",align:"center",width:100,render:function(e){return g.a.createElement("div",{className:F.a.operationBox},j?g.a.createElement("span",{onClick:function(){return Se(e)},style:{display:j?"unset":"none"}},"\u7f16\u8f91"):"--",e.attachment&&g.a.createElement("span",{onClick:function(){return je(e.riskRecordId)},style:{display:v?"unset":"none"}},"\u4e0b\u8f7d"))}}],Re=function(){var e=x.getFieldsValue();Object(T["g"])({method:"post",url:"/riskRecord/downloadAll",data:e,callback:function(e){var t=e.status;"success"===t&&Q("success","\u63d0\u9192","\u5bfc\u51fa\u6210\u529f"),"error"===t&&Q("error","\u63d0\u9192","\u5bfc\u51fa\u5931\u8d25\uff01")}})},De=g.a.createElement(d["a"],null,g.a.createElement(d["a"].Item,{key:"0",disabled:!Z.length},g.a.createElement("span",{onClick:function(e){return je(Z)}},"\u5bfc\u51fa\u9009\u4e2d")),g.a.createElement(d["a"].Item,{key:"1"},g.a.createElement("span",{onClick:function(){return Re()}},"\u5bfc\u51fa\u5168\u90e8")));return Object(y["useEffect"])((function(){var t=e.dispatch;t({type:"risk/queryRiskLevel",payload:{askType:""},callback:function(e){he(e)}})}),[]),Object(y["useEffect"])((function(){var t=e.dispatch;t({type:"risk/queryRiskList",payload:Object(p["a"])(Object(p["a"])({},J),R),callback:function(e){_(e),$([])}})}),[J,R.pageSize,R.pageNum]),g.a.createElement(h["a"],{title:"\u98ce\u9669\u6d4b\u8bc4\u95ee\u5377\u5217\u8868"},g.a.createElement(O["a"],null,g.a.createElement(m["a"],{visible:q,footer:null,onCancel:function(){return Y(!1)},width:"80%",maskClosable:!1,destroyOnClose:!0},g.a.createElement(A,{closeModal:ee,riskRecordId:ne,isEdit:se,upDataParentData:Ce,askType:Ee})),g.a.createElement(n["a"],null,g.a.createElement(b["a"],Object(l["a"])({},t,{form:x,onFinish:xe}),g.a.createElement(i["a"],{gutter:24,style:{width:"100%"}},g.a.createElement(o["a"],{span:8},g.a.createElement(b["a"].Item,{name:"customerName",label:"\u5ba2\u6237\u540d\u79f0"},g.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165"}))),g.a.createElement(o["a"],{span:8},g.a.createElement(b["a"].Item,{name:"customerType",label:"\u5ba2\u6237\u7c7b\u578b"},g.a.createElement(k["a"],{placeholder:"\u8bf7\u9009\u62e9",allowClear:!0},g.a.createElement(M,{value:1},"\u4e2a\u4eba"),g.a.createElement(M,{value:2},"\u673a\u6784"),g.a.createElement(M,{value:3},"\u4ea7\u54c1")))),g.a.createElement(o["a"],{span:8},g.a.createElement(b["a"].Item,{name:"riskType",label:"\u98ce\u9669\u7b49\u7ea7"},g.a.createElement(k["a"],{placeholder:"\u8bf7\u9009\u62e9",allowClear:!0},ge.map((function(e){return g.a.createElement(M,{value:e.type,key:e.type},e.text||"--")})))))),g.a.createElement(i["a"],{gutter:24,style:{width:"100%"}},g.a.createElement(o["a"],{span:8},g.a.createElement(b["a"].Item,{name:"usableStatus",label:"\u95ee\u5377\u6709\u6548\u6027"},g.a.createElement(k["a"],{placeholder:"\u8bf7\u9009\u62e9",allowClear:!0},g.a.createElement(M,{value:0},"\u6709\u6548"),g.a.createElement(M,{value:1},"\u65e0\u6548")))),g.a.createElement(o["a"],{span:8},g.a.createElement(b["a"].Item,{name:"isUseSeal",label:"\u95ee\u5377\u7528\u5370\u72b6\u6001"},g.a.createElement(k["a"],{placeholder:"\u8bf7\u9009\u62e9",allowClear:!0},g.a.createElement(M,{value:0},"\u6ca1\u6709\u7528\u5370"),g.a.createElement(M,{value:1},"\u5df2\u7528\u5370")))),g.a.createElement(o["a"],{span:8},g.a.createElement(b["a"].Item,{name:"sourceType",label:"\u95ee\u5377\u6765\u6e90"},g.a.createElement(k["a"],{placeholder:"\u8bf7\u9009\u62e9",allowClear:!0},g.a.createElement(M,{value:1},"\u7ebf\u4e0a\u586b\u5199"),g.a.createElement(M,{value:2},"\u540e\u53f0\u521b\u5efa"),g.a.createElement(M,{value:3},"\u7535\u5b50\u5408\u540c\u7b7e\u7ea6"),g.a.createElement(M,{value:4},"\u975e\u7535\u5b50\u5408\u540c\u7b7e\u7ea6"))))),g.a.createElement(i["a"],{gutter:24,style:{width:"100%"}},g.a.createElement(o["a"],{span:8},g.a.createElement(b["a"].Item,{name:"riskLimitDate",label:"\u95ee\u5377\u5230\u671f\u65f6\u95f4"},g.a.createElement(s["a"],{style:{width:"100%"}}))),g.a.createElement(o["a"],{span:8},g.a.createElement(b["a"].Item,{label:"\u8bc1\u4ef6\u53f7\u7801",name:"cardNumber"},g.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165",autoComplete:"off",allowClear:!0}))),g.a.createElement(o["a"],{span:8},g.a.createElement("div",{className:F.a.btnBox},g.a.createElement(c["a"],{htmlType:"button",onClick:Ie,className:F.a.raestBtn},"\u91cd\u7f6e"),g.a.createElement(c["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2"))))),g.a.createElement("div",{className:F.a.btnGroup,style:{display:v?"unset":"none"}},g.a.createElement(r["a"],{overlay:De,trigger:["click"]},g.a.createElement(c["a"],{loading:Boolean(me)},"\u6279\u91cf\u5bfc\u51fa"))),g.a.createElement("div",{className:F.a.table},g.a.createElement(U["a"],{loading:Boolean(e.loading)||Boolean(me),columns:Te,dataSource:K.list||[],total:K.total,pageNum:R.pageNum,scroll:{x:"100%"},sticky:!0,onChange:function(e,t,a){return Oe(e,t,a)},rowSelection:we,rowKey:"riskRecordId"})))))};t["default"]=Object(x["connect"])((function(e){var t=e.risk,a=e.loading;return{risk:t,loading:a.effects["risk/queryRiskList"]}}))(Y)},"9xjH":function(e,t,a){e.exports={box:"antd-pro-pages-risk-list-components-modal-page-styles-box",btnG:"antd-pro-pages-risk-list-components-modal-page-styles-btnG",subBtn:"antd-pro-pages-risk-list-components-modal-page-styles-subBtn",uploadBox:"antd-pro-pages-risk-list-components-modal-page-styles-uploadBox"}},d6hm:function(e,t,a){e.exports={btnBox:"antd-pro-pages-risk-list-styles-btnBox",raestBtn:"antd-pro-pages-risk-list-styles-raestBtn",btnGroup:"antd-pro-pages-risk-list-styles-btnGroup",addBtn:"antd-pro-pages-risk-list-styles-addBtn",alert:"antd-pro-pages-risk-list-styles-alert",operationBox:"antd-pro-pages-risk-list-styles-operationBox"}}}]);