(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[51],{"91yE":function(e,t,a){"use strict";a.r(t);var n=a("fWQN"),r=a("mtLc"),c=a("yKVA"),o=a("879j"),s=a("q1tI"),l=a.n(s),i=(a("IzEo"),a("bx4M")),m=(a("+L6B"),a("2/Rp")),d=a("0Owb"),p=(a("/xke"),a("TeRw")),u=(a("FJo9"),a("L41K")),f=a("Hx5s"),b=a("wd/R"),g=a.n(b),E=a("9kvl"),y=(a("5NDa"),a("5rEg")),I=a("k1fw"),h=a("tJVT"),v=(a("y8nQ"),a("Vl3Y")),j=a("ZW13"),O=a.n(j),k=a("jCRI"),N=a.n(k),S=v["a"].Item,D=function(e){var t=e.params,a=e.dispatch,n=e.codeValue,r=Object(s["useState"])({}),c=Object(h["a"])(r,2),o=c[0],m=c[1];Object(s["useEffect"])((function(){a({type:"SIGN_REDEMING/getBaseInfo",payload:Object(I["a"])(Object(I["a"])({},t),{},{codeValue:n}),callback:function(e){1008===e.code&&m(e.data)}})}),[1]);var p={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:12},md:{span:10}}};return l.a.createElement(i["a"],{bordered:!1},l.a.createElement(v["a"],{hideRequiredMark:!0,scrollToFirstError:!0,name:"detail"},l.a.createElement(S,Object(d["a"])({},p,{label:"\u8d4e\u56de\u7533\u8bf7\u8868\u786e\u8ba4"}),l.a.createElement(y["a"],{disabled:!0,value:o.buyConfirmTime&&g()(o.buyConfirmTime).format("YYYY/MM/DD HH:mm:ss")||"--"})),l.a.createElement(S,Object(d["a"])({},p,{label:"\u8d4e\u56de\u7533\u8bf7\u8868\u64cd\u4f5c\u7559\u75d5"}),l.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:o.buyMarkUrl},o.buyMarkUrl?l.a.createElement("img",{src:O.a,className:N.a.ImgStyle,alt:""}):"\u6682\u65e0"))))},T=Object(E["b"])((function(e){var t=e.SIGN_REDEMING;return{SIGN_REDEMING:t,infomation:t.infomation}}))(D),w=(a("sRBo"),a("kaz8")),M=a("+n12"),R=y["a"].TextArea,V=function(e,t,a,n,r){p["default"][e||"info"]({top:165,message:t,description:a,placement:n,duration:r||3})},C=v["a"].Item,G={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:12},md:{span:10}}},x={wrapperCol:{xs:{span:24,offset:0},sm:{span:10,offset:7}}},Y=function(e){var t=e.params,a=e.dispatch,n=e.loading,r=e.codeValue,c=e.authEdit,o=Object(M["n"])(),p=o.key,u=v["a"].useForm(),f=Object(h["a"])(u,1),b=f[0],j=Object(s["useState"])({}),k=Object(h["a"])(j,2),S=k[0],D=k[1],T=Object(s["useState"])(""),Y=Object(h["a"])(T,2),L=Y[0],H=Y[1],_=Object(s["useState"])(""),F=Object(h["a"])(_,2),B=F[0],P=F[1];Object(s["useEffect"])((function(){a({type:"SIGN_REDEMING/getBaseInfo",payload:Object(I["a"])(Object(I["a"])({},t),{},{codeValue:r}),callback:function(e){1008===e.code&&(D(e.data),e.data&&b.setFieldsValue(Object(I["a"])({},e.data)))}})}),[1]);var A=function(e){var t=b.getFieldsValue();a({type:"SIGN_REDEMING/saveAudit",payload:{signFlowId:S.signFlowId,feedback:L,checkType:e,codeValueList:t.codeValueList},callback:function(e){var t=Object(M["n"])(),a=t.type;if(a&&("customerType"===a?window.sessionStorage.setItem("customer","tab4"):window.sessionStorage.setItem("product","tab6")),e&&1008===e.code)V("success","\u63d0\u4ea4\u6210\u529f",e.message,"topRight"),E["c"].go(-1);else{var n=e.message||e.data||"\u5ba1\u6838\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01";V("warning","\u63d0\u793a\uff08\u4ee3\u7801\uff1a".concat(e.code,"\uff09"),n,"topRight")}}})},J=function(e){P(e),2===e?b.validateFields().then((function(){A(e)})):A(e)},U=function(e){H(e.target.value)};return l.a.createElement(i["a"],{bordered:!1},l.a.createElement(v["a"],{hideRequiredMark:!0,name:" materialScience",className:N.a.stepFrom,form:b},S.sealedDocuments&&S.sealedDocuments.map((function(e,t){return l.a.createElement(s["Fragment"],{key:t},l.a.createElement("h3",null,l.a.createElement("b",null,e.documentName)),l.a.createElement(C,Object(d["a"])({},G,{label:"\u7528\u5370\u65f6\u95f4"}),l.a.createElement(y["a"],{disabled:!0,value:e.sealTime&&g()(e.sealTime).format("YYYY/MM/DD HH:mm:ss")||"--"})),l.a.createElement(C,Object(d["a"])({},G,{label:"\u7528\u5370\u540e\u7684\u6587\u4ef6"}),l.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:e.sealedUrl},e.sealedUrl?l.a.createElement("img",{src:O.a,className:N.a.ImgStyle,alt:""}):"\u6682\u65e0")))})),l.a.createElement(C,Object(d["a"])({},G,{label:"\u53cd\u9988",name:"feedback"}),l.a.createElement(R,{disabled:1===S.checkType,placeholder:"\u8bf7\u8f93\u5165\u53cd\u9988\u610f\u89c1",onChange:U})),l.a.createElement(C,Object(d["a"])({},G,{label:"\u5ba1\u6838\u4e0d\u901a\u8fc7\u7684\u6b65\u9aa4",name:"codeValueList",rules:[{required:!0,message:"\u8bf7\u9009\u62e9"}]}),l.a.createElement(w["a"].Group,null,Array.isArray(S.fallbackNodeList)&&S.fallbackNodeList.map((function(e){return l.a.createElement(w["a"],{key:e.codeValue,value:e.codeValue},e.codeText)})))),"tab3"!==p&&c&&l.a.createElement(C,x,l.a.createElement(m["a"],{type:"primary",loading:1===B&&n,disabled:!!S.checkType,onClick:function(){J(1)}},"\u5ba1\u6838\u901a\u8fc7"),l.a.createElement(m["a"],{type:"primary",loading:2===B&&n,disabled:!!S.checkType,style:{marginLeft:10},onClick:function(){J(2)}},"\u5ba1\u6838\u4e0d\u901a\u8fc7"))))},L=Object(E["b"])((function(e){var t=e.SIGN_REDEMING,a=e.loading;return{SIGN_REDEMING:t,infomation:t.infomation,loading:a.effects["SIGN_REDEMING/saveAudit"]}}))(Y),H=(a("J+/v"),a("MoRW")),_=(a("bP8k"),a("gFTJ")),F=function(e){var t,a=e.params,n=e.dispatch,r=Object(s["useState"])({}),c=Object(h["a"])(r,2),o=c[0],m=c[1];Object(s["useEffect"])((function(){n({type:"applyPurchase/getBaseInfo",payload:Object(I["a"])(Object(I["a"])({},a),{},{codeValue:3040}),callback:function(e){1008===e.code&&m(e.data)}})}),[1]),o.createTime&&o.updateTime&&(t=Object(M["h"])((new Date(o.updateTime)-new Date(o.createTime))/1e3).data);var d=l.a.createElement(_["b"],{column:1,style:{position:"absolute",left:"50%",marginLeft:"-100px"}},l.a.createElement(_["b"].Item,{label:"\u6295\u8d44\u8005\u540d\u79f0"},o.customerName),l.a.createElement(_["b"].Item,{label:"\u4ea7\u54c1\u540d\u79f0"},o.productName),l.a.createElement(_["b"].Item,{label:"\u53d1\u8d77\u65f6\u95f4"},o.createTime&&g()(o.createTime).format("YYYY/MM/DD HH:mm:ss")),l.a.createElement(_["b"].Item,{label:"\u8017\u65f6"},t||"--"),l.a.createElement(_["b"].Item,{label:"\u5b8c\u6210\u65f6\u95f4"},o.updateTime&&g()(o.updateTime).format("YYYY/MM/DD HH:mm:ss")));return l.a.createElement(i["a"],{bordered:!1,style:{background:"#fff",height:"50vh"}},l.a.createElement(H["a"],{className:N.a.step11Content,status:"success",title:l.a.createElement("h3",null,"\u5b8c\u6210"),subTitle:d}))},B=Object(E["b"])((function(e){var t=e.applyPurchase;return{applyPurchase:t,infomation:t.infomation}}))(F),P=a("LvDl"),A=u["a"].Step,J=function(e,t,a,n,r){p["default"][e||"info"]({top:165,message:t,description:a,placement:n,duration:r||3})},U=function(e){Object(c["a"])(a,e);var t=Object(o["a"])(a);function a(e){var r;return Object(n["a"])(this,a),r=t.call(this,e),r.goback=function(){var e=Object(M["n"])(),t=e.type,a=e.key;t&&("customerType"===t?window.sessionStorage.setItem("customer","tab4"):window.sessionStorage.setItem("product","tab6")),a&&window.sessionStorage.setItem("processTabKey",a),history.go(-1)},r.changeProcessStep=function(e){var t=r.state.standardCurrent;if(e>t){var a="\u6682\u672a\u8fdb\u884c\u5230\u8be5\u6b65\u9aa4\uff0c\u65e0\u6cd5\u67e5\u770b";return J("warning","\u63d0\u793a",a,"topRight")}return r.setState({current:e}),!0},r.getInfo=function(){var e=r.props,t=e.dispatch,a=e.params;t({type:"SIGN_REDEMING/getProcessList",payload:a,callback:function(e){if(e&&1008===e.code){var t=[];!Object(P["isEmpty"])(e.data)&&e.data.forEach((function(e){t.push(e.codeValue)})),r.setState({operationInfo:e.data,returnCodeList:t})}else{var a=e.message||e.data||"\u6d41\u7a0b\u8282\u70b9\u64cd\u4f5c\u4fe1\u606f\u67e5\u8be2\u5931\u8d25\uff01";J("warning","\u63d0\u793a(\u4ee3\u7801\uff1a".concat(e.code,")"),a,"topRight")}}}).then((function(){t({type:"SIGN_REDEMING/getBaseInfo",payload:a,callback:function(e){if(1008===e.code){var t=e.data;r.setState({data:t}),r.convertStep(t.nextCodeValue)}else{var a=e.message||e.data||"\u6d41\u7a0b\u8be6\u60c5\u67e5\u8be2\u5931\u8d25\uff01";J("warning","\u63d0\u793a(\u4ee3\u7801\uff1a".concat(e.code,")"),a,"topRight")}}})}))},r.renderDescription=function(e){var t=r.state.operationInfo;return!(t.length>0&&t[e]&&0===t[e].isDelete)||(t[e]&&4040===t[e].codeValue?null:l.a.createElement("div",{style:{fontSize:12,textIndent:"-1em",zIndex:999}},l.a.createElement("div",{style:{width:80}},t[e]&&(4020===t[e].codeValue?"\u5ba1\u6838\u5458:":"\u6295\u8d44\u8005:"),t[e]&&t[e].userName||"--"),l.a.createElement("div",{style:{textIndent:"-3em"}},t[e]&&(t[e].updateTime?g()(t[e].updateTime).format("YYYY/MM/DD HH:mm:ss"):""))))},r.renderTitle=function(e){var t=r.state.operationInfo;return!(t.length>0&&t[e])||t[e].codeText},r.convertStep=function(e){var t=r.state.returnCodeList,a=0;t.forEach((function(t,n){t===e&&(a=n)})),e||(a=2),r.setState({current:a,standardCurrent:a})},r.state={current:0,standardCurrent:0,operationInfo:[],data:{},stepNum:0,returnCodeList:[]},r.processStepsList=[{id:1,codeValue:4010,title:"\u8d4e\u56de\u786e\u8ba4\u4e66",component:l.a.createElement(T,{params:r.props.params,codeValue:4010})},{id:2,codeValue:4020,title:"\u7ba1\u7406\u4eba\u5ba1\u6838",component:l.a.createElement(L,Object(d["a"])({params:r.props.params,codeValue:4020},Object(M["o"])("productTab"===Object(M["n"])().type?30106:"customerType"===Object(M["n"])().type?10106:20200)))},{id:3,codeValue:4040,title:"\u5b8c\u6210",component:l.a.createElement(B,{params:r.props.params,codeValue:4040})}],r}return Object(r["a"])(a,[{key:"componentDidMount",value:function(){this.props.dispatch;this.getInfo()}},{key:"componentWillUnmount",value:function(){var e=this.props.dispatch,t={processDetail:{}};e({type:"SIGN_REDEMING/resetModel",payload:t})}},{key:"render",value:function(){var e=this,t=this.state,a=t.current,n=t.returnCodeList,r=this.processStepsList.filter((function(e){return n.includes(e.codeValue)}));return l.a.createElement(f["a"],{title:"\u8ba4\u7533\u8d4e\u6d41\u7a0b",extra:l.a.createElement(m["a"],{type:"primary",onClick:this.goback},"\u8fd4\u56de\u4e0a\u4e00\u6b65"),className:N.a.pageHeader},l.a.createElement(i["a"],null,l.a.createElement("div",{className:N.a.longStep},l.a.createElement(u["a"],{current:a,className:N.a.steps,onChange:this.changeProcessStep},r.map((function(t,a){return l.a.createElement(A,{key:t.id,title:e.renderTitle(a),description:e.renderDescription(a)})})))),r[a]&&r[a].component))}}]),a}(s["Component"]),q=Object(E["b"])((function(e){var t=e.loading;return{loading:t.effects["SIGN_REDEMING/getBaseInfo"]}}))(U),z=function(e){Object(c["a"])(a,e);var t=Object(o["a"])(a);function a(){return Object(n["a"])(this,a),t.apply(this,arguments)}return Object(r["a"])(a,[{key:"render",value:function(){var e=this.props.match.params;return l.a.createElement("div",null,l.a.createElement(q,{params:e}))}}]),a}(s["Component"]);t["default"]=z},jCRI:function(e,t,a){e.exports={main:"antd-pro-pages-components-m-x-sign-info-redeming-style-main",headerList:"antd-pro-pages-components-m-x-sign-info-redeming-style-headerList",stepDescription:"antd-pro-pages-components-m-x-sign-info-redeming-style-stepDescription",pageHeader:"antd-pro-pages-components-m-x-sign-info-redeming-style-pageHeader",moreInfo:"antd-pro-pages-components-m-x-sign-info-redeming-style-moreInfo",ImgStyle:"antd-pro-pages-components-m-x-sign-info-redeming-style-ImgStyle"}}}]);