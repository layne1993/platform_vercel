(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[29],{VjBs:function(e,t,a){"use strict";a.r(t);a("IzEo");var n=a("bx4M"),r=a("0Owb"),i=(a("14J3"),a("BMrR")),c=(a("+L6B"),a("2/Rp")),o=(a("jCWc"),a("kPKH")),l=(a("5NDa"),a("5rEg")),s=a("k1fw"),u=(a("y8nQ"),a("Vl3Y")),m=a("tJVT"),d=(a("/xke"),a("TeRw")),p=(a("OaEy"),a("2fM7")),f=a("q1tI"),g=a.n(f),b=a("9kvl"),E=a("Hx5s"),v=a("FRQA"),y=a("wd/R"),h=a.n(y),I=a("tQHx"),w=(a("2qtc"),a("kLXV")),O=(a("T2oS"),a("W9HT")),S=(a("DZo9"),a("8z0m")),N=a("9og8"),j=a("PpiC"),C=a("WmNS"),T=a.n(C),x=a("z7Xi"),k=a("+n12"),D=a("AEkp"),A=a("yDTz"),F=a.n(A),V=a("yEr3"),L=a.n(V),q=(a("Psm9"),a("Lzxq"),["bold","italic","underline","text-color","separator"]),B={labelCol:{span:4},wrapperCol:{span:20}},P=function(e,t,a,n,r){d["default"][e||"info"]({top:30,message:t,description:a,placement:n,duration:r||3})},R=p["a"].Option;function z(e){var t=e.loadingSubmit,a=e.loadingGetDetail,n=e.loadingCreate,i=e.visible,o=e.setVisible,d=e.tableSearch,b=e.id,E=void 0===b?null:b,v=e.data,y=u["a"].useForm(),h=Object(m["a"])(y,1),I=h[0],C=Object(f["useState"])([]),A=Object(m["a"])(C,2),V=A[0],z=A[1],M=Object(f["useState"])(1),U=Object(m["a"])(M,2),H=U[0],J=U[1],Y=Object(f["useState"])(2),Q=Object(m["a"])(Y,2),W=Q[0],_=Q[1],G=Object(f["useState"])([]),K=Object(m["a"])(G,2),X=K[0],Z=K[1];Object(f["useEffect"])((function(){var t=e.dispatch;if(t({type:"global/queryByProductName",callback:function(e){1008===e.code&&Z(e.data)}}),E){var a=v.noticeType,n=v.noticePerson,r=v.productIds,i=v.content,c=v.attachmentsId,o=v.fileName,l=void 0===o?null:o,u=v.fileUrl,m=void 0===u?null:u,d=i&&L.a.createEditorState(i)||null,p=c&&[{uid:c,name:l,url:m,status:"done"}]||null,f=r&&"string"===typeof r&&r.split(",")||[],g=f.map((function(e){return Number(e)}));z(p),_(a),J(n),I.setFieldsValue(Object(s["a"])(Object(s["a"])({},v),{},{noticeType:a,noticePerson:n,productIds:g||[],content:d,fileList:p}))}}),[]);var $=function(){var t=I.validateFields;t().then((function(t){var a=e.dispatch,n=E?"updateNotice":"createNotice",r=t.fileList,i=t.readTime,c=t.content,l=t.customerType,u=t.productIds,m=Object(j["a"])(t,["fileList","readTime","content","customerType","productIds"]),p=r&&r.map((function(e){return e.uid}))||null,f=c&&c.toHTML()||null,g=Array.isArray(u)&&u.join(",")||"";a({type:"confirmAnnouncementSettings/".concat(n),payload:Object(s["a"])(Object(s["a"])({},m),{},{attachmentsId:Array.isArray(p)&&p[0]||null,content:f,readTime:Number(i),customerType:l||null,productIds:g||null,contraintNoticeId:E}),callback:function(e){var t=e.code,a=void 0===t?"":t,n=e.message,r=void 0===n?"":n;1008===a?(P("success","\u63d0\u793a","\u4fdd\u5b58\u6210\u529f"),d(),o(!1)):P("warning","\u63d0\u793a\uff08\u4ee3\u7801\uff1a".concat(a,"\uff09"),"".concat(r||"\u4fdd\u5b58\u5931\u8d25\uff01"),"topRight")}})}))},ee=function(){var e=Object(N["a"])(T.a.mark((function e(t){var a,n,r,i;return T.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.file,n=t.fileList,"uploading"!==a.status&&"removed"!==a.status){e.next=4;break}return z(n),e.abrupt("return");case 4:"done"===a.status&&(1008===a.response.code?(r=a.response.data||{},P("success","\u63d0\u9192","\u4e0a\u4f20\u6210\u529f"),i=[{uid:r.attachmentsId,name:r.fileName,url:r.baseUrl,status:"done"}],z(i),I.setFieldsValue({fileList:i})):P("warning","\u63d0\u9192","\u4e0a\u4f20\u5931\u8d25"));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=Object(N["a"])(T.a.mark((function e(t){var a,n,r;return T.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,D["a"].get("/attachments/deleteFile",{attachmentsId:t.uid});case 2:a=e.sent,n=I.getFieldValue("fileList")||[],r=[],1008===a.code&&(r=n.filter((function(e){return e.uid!==t.uid})),0===r.length?I.setFieldsValue({fileList:[]}):I.setFieldsValue({fileList:r}),z(r));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ae=function(e){return Array.isArray(e)?e:e&&e.fileList};return console.log(e),g.a.createElement(w["a"],{visible:i,maskClosable:!1,onCancel:function(){return o(!1)},onOk:$,wrapClassName:F.a.addNew,title:"\u65b0\u5efa\u5f3a\u5236\u786e\u8ba4\u516c\u544a"},g.a.createElement(u["a"],Object(r["a"])({initialValues:{isDelete:0,readTime:10}},B,{form:I,onFinish:$}),g.a.createElement(u["a"].Item,{label:"\u516c\u544a\u540d\u79f0:",name:"noticeName",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u516c\u544a\u540d\u79f0!"},{max:70,message:"\u6700\u591a\u8f93\u516570\u4e2a\u5b57\u7b26"}]},g.a.createElement(l["a"],{max:140})),g.a.createElement(u["a"].Item,{label:"\u751f\u6548\u72b6\u6001:",name:"isDelete",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u751f\u6548\u72b6\u6001!"}]},g.a.createElement(p["a"],{placeholder:"\u8bf7\u9009\u62e9",allowClear:!0},g.a.createElement(R,{value:0},"\u6709\u6548"),g.a.createElement(R,{value:1},"\u65e0\u6548"))),g.a.createElement(u["a"].Item,{label:"\u5f3a\u5236\u9605\u8bfb\u65f6\u957f(\u79d2)",name:"readTime",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5f3a\u5236\u9605\u8bfb\u65f6\u957f!"}]},g.a.createElement(l["a"],{max:140,type:"number",min:0})),g.a.createElement(u["a"].Item,{label:"\u516c\u544a\u5bf9\u8c61:",name:"noticePerson",initialValue:1,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u516c\u544a\u5bf9\u8c61!"}]},g.a.createElement(p["a"],{placeholder:"\u8bf7\u9009\u62e9",allowClear:!0,onChange:function(e){return J(e)}},g.a.createElement(R,{value:1},"\u6240\u6709\u4eba"),g.a.createElement(R,{value:2},"\u7279\u5b9a\u5bf9\u8c61"))),2===H&&g.a.createElement(g.a.Fragment,null,g.a.createElement(u["a"].Item,{label:"\u5ba2\u6237\u7c7b\u578b:",name:"customerType",rules:[{required:!1,message:"\u8bf7\u9009\u62e9\u5ba2\u6237\u7c7b\u578b!"}]},g.a.createElement(p["a"],{placeholder:"\u8bf7\u9009\u62e9",allowClear:!0},g.a.createElement(R,{value:1},"\u81ea\u7136\u4eba\u5ba2\u6237"),g.a.createElement(R,{value:2},"\u673a\u6784\u5ba2\u6237"),g.a.createElement(R,{value:3},"\u4ea7\u54c1\u5ba2\u6237"))),g.a.createElement(u["a"].Item,{label:"\u6301\u6709\u4ea7\u54c1:",name:"productIds",rules:[{required:!1,message:"\u8bf7\u9009\u62e9\u6301\u6709\u4ea7\u54c1!"}]},g.a.createElement(p["a"],{placeholder:"\u8bf7\u9009\u62e9",allowClear:!0,mode:"multiple"},X.map((function(e){return g.a.createElement(R,{value:e.productId,key:e.productId},e.productName)}))))),g.a.createElement(u["a"].Item,{label:"\u516c\u544a\u7c7b\u578b:",name:"noticeType",initialValue:2,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u516c\u544a\u7c7b\u578b!"}]},g.a.createElement(p["a"],{placeholder:"\u8bf7\u9009\u62e9",allowClear:!0,onChange:function(e){return _(e)}},g.a.createElement(R,{value:1},"\u6587\u5b57\u516c\u544a"),g.a.createElement(R,{value:2},"\u6587\u4ef6\u516c\u544a"))),1===W&&g.a.createElement(u["a"].Item,{label:"\u8bf7\u8f93\u5165\u5185\u5bb9",name:"content",initialValue:L.a.createEditorState(""),rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5185\u5bb9!"},function(){return{validator:function(e,t){return t.isEmpty()?Promise.reject(new Error("\u8bf7\u8f93\u5165\u5185\u5bb9!")):Promise.resolve()}}}]},g.a.createElement(L.a,{style:{border:"1px solid #d9d9d9",width:"100%"},contentStyle:{height:"300px"},controls:q})),2===W&&g.a.createElement(u["a"].Item,{label:"\u9605\u8bfb\u6587\u4ef6",name:"fileList",extra:"\u6700\u5927\u53ef\u652f\u630120M\u4ee5\u5185\u7684PDF\u6587\u4ef6",rules:[{required:!0,message:"\u8bf7\u4e0a\u4f20\u6587\u4ef6!",type:"array"}],getValueFromEvent:ae},g.a.createElement(S["a"],{action:"".concat({baseUrl:"/sitvipmanager/",adminUrl:"/vip-manager",ASSSET_DOMIAN:"RESOURCE_PATH",AI:{AI_type:2},isSaas:2}.adminUrl,"/attachments/uploadFile"),headers:{tokenId:Object(k["l"])("vipAdminToken")},accept:".pdf",data:{sourceId:"",source:25,codeType:167},fileList:V,onChange:ee,onRemove:te,maxCount:1},g.a.createElement(c["a"],{disabled:V&&V.length,icon:g.a.createElement(x["a"],null),size:"middle"},"\u4e0a\u4f20")))),(t||a||n)&&g.a.createElement("div",{className:"consulteModalLoading"},g.a.createElement(O["a"],null)))}var M=Object(b["b"])((function(e){var t=e.loading;return{loadingSubmit:t.effects["confirmAnnouncementSettings/createNotice"],loadingCreate:t.effects["confirmAnnouncementSettings/updateNotice"],loadingGetDetail:t.effects["confirmAnnouncementSettings/getQuestionDetail"]}}))(z),U=a("e0oS"),H=a.n(U),J=p["a"].Option,Y={labelCol:{span:6},wrapperCol:{span:18}},Q={pageNum:1,pageSize:20},W=function(e,t,a,n,r){d["default"][e||"info"]({top:30,message:t,description:a,placement:n,duration:r||3})},_={0:"\u6709\u6548",1:"\u65e0\u6548"},G={1:"\u6240\u6709\u4eba",2:"\u7279\u5b9a\u5bf9\u8c61"},K={1:"\u6587\u5b57\u516c\u544a",2:"\u6587\u4ef6\u516c\u544a"};function X(e){var t=[{title:"\u516c\u544a\u540d\u79f0",dataIndex:"noticeName",width:210,render:function(e){return e||"--"}},{title:"\u751f\u6548\u72b6\u6001",dataIndex:"isDelete",align:"center",width:320,render:function(e){return e&&_[e]||"\u6709\u6548"}},{title:"\u516c\u544a\u7c7b\u578b",dataIndex:"noticeType",width:120,align:"center",render:function(e){return e&&K[e]||"--"}},{title:"\u5f3a\u5236\u9605\u8bfb\u65f6\u95f4",dataIndex:"readTime",width:120,align:"center",render:function(e){return e||"--"}},{title:"\u786e\u8ba4\u5bf9\u8c61",dataIndex:"noticePerson",width:120,align:"center",render:function(e){return e&&G[e]||"--"}},{title:"\u5df2\u786e\u8ba4",dataIndex:"confirmCount",width:120,align:"center",render:function(e){return e||"--"}},{title:"\u672a\u786e\u8ba4",dataIndex:"noConfirmCount",width:120,align:"center",render:function(e){return e||"--"}},{title:"\u6700\u8fd1\u4fee\u6539\u65f6\u95f4",dataIndex:"updateTime",width:120,align:"center",render:function(e){return e&&h()(e).format("YYYY-MM-DD")||"--"}},{title:"\u4fee\u6539\u4eba",dataIndex:"operateUserName",width:120,align:"center",render:function(e){return e||"--"}},{title:"\u64cd\u4f5c",align:"center",width:200,render:function(e){return g.a.createElement("div",{className:H.a.operationBox},g.a.createElement("span",{onClick:function(){return ae(e)}},"\u786e\u8ba4\u660e\u7ec6"),g.a.createElement("span",{onClick:function(){return ne(e)}},"\u7f16\u8f91"),g.a.createElement("span",{onClick:function(){return re(e)}},e.isDelete?"\u8bbe\u4e3a\u6709\u6548":"\u8bbe\u4e3a\u65e0\u6548"))}}],a=Object(f["useState"])(Q),d=Object(m["a"])(a,2),y=d[0],w=d[1],O=Object(f["useState"])({}),S=Object(m["a"])(O,2),N=S[0],j=S[1],C=Object(f["useState"])(null),T=Object(m["a"])(C,2),x=T[0],k=T[1],D=Object(f["useState"])({}),A=Object(m["a"])(D,2),F=A[0],V=A[1],L=Object(f["useState"])(!1),q=Object(m["a"])(L,2),B=q[0],P=q[1],R=u["a"].useForm(),z=Object(m["a"])(R,1),U=z[0],X=function(){var t=e.dispatch,a=U.getFieldsValue();t({type:"confirmAnnouncementSettings/getTableData",payload:Object(s["a"])(Object(s["a"])({},a),y),callback:function(e){if(1008===e.code){var t=e.data||{},a=t.list,n=void 0===a?[]:a,r=t.total;j({list:n,total:r})}else W("warning","\u63d0\u793a\uff08\u4ee3\u7801\uff1a".concat(e.code,"\uff09"),"".concat(e.message?e.message:"\u83b7\u53d6\u6570\u636e\u5931\u8d25!"),"topRight")}})},Z=function(e,t,a){w(Object(s["a"])(Object(s["a"])({},y),{},{pageNum:e.current,pageSize:e.pageSize}))},$=function(){w(Q),X()},ee=function(){U.setFieldsValue({noticeName:"",isDelete:null}),X()},te=function(){k(""),V({}),P(!0)},ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.contraintNoticeId){var t=JSON.stringify({noticeName:e.noticeName||"",readTime:e.readTime||0,noConfirmCount:e.noConfirmCount||0,confirmCount:e.confirmCount||0});sessionStorage.setItem("confirmInformation",t),b["c"].push("/infoDisclosure/confirmAnnouncementSettings/confirmationDocument/".concat(e.contraintNoticeId))}},ne=function(e){k(e.contraintNoticeId),V(e),P(!0)},re=function(t){var a=e.dispatch;a({type:"confirmAnnouncementSettings/updateNoticeStatus",payload:{contraintNoticeId:t.contraintNoticeId,isDelete:Number(!t.isDelete)},callback:function(e){1008===e.code?X():W("warning","\u63d0\u793a\uff08\u4ee3\u7801\uff1a".concat(e.code,"\uff09"),"".concat(e.message?e.message:"\u8bbe\u7f6e\u5931\u8d25!"),"topRight")}})};return Object(f["useEffect"])((function(){X()}),[y]),g.a.createElement(E["a"],{title:"\u5f3a\u5236\u786e\u8ba4\u6587\u4ef6"},g.a.createElement(v["a"],null,g.a.createElement(n["a"],null,g.a.createElement("div",{className:H.a.confirmationDocument},g.a.createElement(u["a"],Object(r["a"])({},Y,{form:U,onFinish:$}),g.a.createElement(i["a"],{gutter:24},g.a.createElement(o["a"],{span:6},g.a.createElement(u["a"].Item,{label:"\u516c\u544a\u540d\u79f0:",name:"noticeName"},g.a.createElement(l["a"],{placeholder:"\u8bf7\u8f93\u5165"}))),g.a.createElement(o["a"],{span:6,className:H.a.questionType},g.a.createElement(u["a"].Item,{label:"\u751f\u6548\u72b6\u6001:",name:"isDelete"},g.a.createElement(p["a"],{placeholder:"\u8bf7\u9009\u62e9",allowClear:!0},g.a.createElement(J,{value:0},"\u6709\u6548"),g.a.createElement(J,{value:1},"\u65e0\u6548")))),g.a.createElement(o["a"],{span:6,className:H.a.btns},g.a.createElement(c["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),g.a.createElement(c["a"],{htmlType:"button",className:H.a.resetBtn,onClick:ee},"\u91cd\u7f6e")))),g.a.createElement("div",null,g.a.createElement("div",null,g.a.createElement(c["a"],{type:"primary",onClick:te},"\u65b0\u5efa\u5f3a\u5236\u786e\u8ba4\u516c\u544a")),g.a.createElement(I["a"],{loading:Boolean(e.loading)||Boolean(e.loadingSet),columns:t,dataSource:N.list||[],total:N.total,pageNum:y.pageNum,scroll:{x:"100%"},sticky:!0,onChange:function(e,t,a){return Z(e,t,a)},rowKey:"onlineServiceId"})),B&&g.a.createElement(M,{visible:B,setVisible:P,tableSearch:X,id:x,data:F})))))}t["default"]=Object(b["b"])((function(e){var t=e.loading;return{loading:t.effects["confirmAnnouncementSettings/getTableData"],loadingSet:t.effects["confirmAnnouncementSettings/updateNoticeStatus"]}}))(X)},e0oS:function(e,t,a){e.exports={confirmationDocument:"antd-pro-pages-information-disclosure-confirm-announcement-settings-styles-confirmationDocument",documentTips:"antd-pro-pages-information-disclosure-confirm-announcement-settings-styles-documentTips",operationBox:"antd-pro-pages-information-disclosure-confirm-announcement-settings-styles-operationBox",btns:"antd-pro-pages-information-disclosure-confirm-announcement-settings-styles-btns",resetBtn:"antd-pro-pages-information-disclosure-confirm-announcement-settings-styles-resetBtn"}},yDTz:function(e,t,a){e.exports={addNew:"antd-pro-pages-information-disclosure-confirm-announcement-settings-add-new-styles-addNew",operationBox:"antd-pro-pages-information-disclosure-confirm-announcement-settings-add-new-styles-operationBox"}}}]);