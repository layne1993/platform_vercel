(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[62],{Sndw:function(e,t,a){"use strict";a.r(t);a("DYRE");var n=a("zeV3"),l=(a("qVdP"),a("jsC+")),r=(a("lUTK"),a("BvKs")),c=(a("14J3"),a("BMrR")),i=(a("+L6B"),a("2/Rp")),o=(a("iQDF"),a("+eQT")),s=(a("jCWc"),a("kPKH")),d=(a("5NDa"),a("5rEg")),u=a("k1fw"),m=(a("5Dmo"),a("3S7+")),p=a("fWQN"),h=a("mtLc"),f=a("tS8v"),b=a("yKVA"),E=a("879j"),g=(a("2qtc"),a("kLXV")),w=(a("y8nQ"),a("Vl3Y")),I=(a("OaEy"),a("2fM7")),v=(a("/xke"),a("TeRw")),y=a("9kvl"),O=a("q1tI"),F=a.n(O),S=a("+n12"),C=a("nT/m"),k=a("wd/R"),R=a.n(k),T=a("2Fak"),j=a.n(T),N=a("+YFz"),x=a("RCxd"),A=a("xvlK"),M=a("8Skl"),D=a("LvDl"),_=a("QWqi"),V=a("tQHx"),L=a("Hx5s"),P=a("tEfH"),K=a("o/n1"),U=(a("T2oS"),a("W9HT")),H=(a("DZo9"),a("8z0m")),Y=a("0Owb"),q=(a("fOrg"),a("+KLJ")),B=a("PpiC"),z=a("z7Xi"),Q=I["a"].Option,J=function(e,t,a,n,l){v["default"][e||"info"]({top:165,message:t,description:a,placement:n,duration:l||3})},W=w["a"].Item,Z={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:12},md:{span:10}}},X={wrapperCol:{xs:{span:24,offset:0},sm:{span:10,offset:8}}},G="YYYY/MM/DD HH:mm",$=function(e){Object(b["a"])(a,e);var t=Object(E["a"])(a);function a(e){var n;return Object(p["a"])(this,a),n=t.call(this,e),n.onFinish=function(e){var t=n.props,a=t.dispatch,l=t.onCancel,r=n.state,c=r.fileInfomation,i=r.attachmentsId,o=e.publishTime,s=(e.file,Object(B["a"])(e,["publishTime","file"])),d=o&&new Date("".concat(R()(o).format())).getTime()||void 0,m=Object(u["a"])(Object(u["a"])(Object(u["a"])({},c),s),{},{attachmentsId:i,publishTime:d}),p=new FormData;for(var h in m)m[h]&&p.append(h,m[h]);p.append("file",n.state.file),a({type:"productNoticeBatch/productFileUpload",payload:p,callback:function(e){if(e&&1008===e.code)J("success","\u4fdd\u5b58\u6210\u529f",e.message,"topRight"),n.props.Interfacesearch(),l();else{var t=e.message||e.data||"\u4fdd\u5b58\u4fe1\u606f\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01";J("warning","\u63d0\u793a\uff08\u4ee3\u7801\uff1a".concat(e.code,"\uff09"),t,"topRight")}}})},n.filePreView=function(e){window.open(e.url)},n.beforeUpload=function(e,t){return n.setState({file:e,fileList:t}),!1},n.onRemove=function(){n.setState({fileList:[],file:{}})},n.onFieldsChange=function(e){e[0]&&"isNeedOverprint"===e[0].name.toString()&&(1===e[0].value?n.setState({isNeedOverprint:!0}):n.setState({isNeedOverprint:!1}))},n.state={fileInfomation:{},attachmentsId:"",fileList:[],file:{},powerInfo:{},isNeedOverprint:!1},n.searchFormRef=F.a.createRef(),n}return Object(h["a"])(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.loading,n=t.modalVisible,l=t.onCancel,r=this.state,c=r.fileList,s=(r.isNeedOverprint,F.a.createElement("div",null,F.a.createElement("div",null,"ZIP\u538b\u7f29\u5305\u6587\u4ef6\uff0c\u6587\u4ef6\u540d\u5fc5\u987b\u4e3a\uff1a\u3010\u4ea7\u54c1\u5168\u79f0\u540d\u79f0\u3011-\u5b63\u62a5\u62a5\u544a-\u301020210624\u3011.doc\u3001docx\u6216\u8005PDF\u6587\u4ef6"),F.a.createElement("div",null,"\u516c\u544a\u540d\u79f0\u4e3a\uff1a\u4ea7\u54c1\u5168\u79f0\u540d\u79f0-\u5b63\u62a5\u62a5\u544a-20210624"),F.a.createElement("div",null,"\u5bf9\u5e94\u4ea7\u54c1\u4e3a\uff1a\u3010\u4ea7\u54c1\u5168\u79f0\u540d\u79f0\u3011\uff0c\u7528\u7b2c\u4e00\u4e2a-\u7684\u524d\u9762\u7684\u6240\u6709\u6587\u5b57\uff0c\u4e0d\u6ee1\u8db3\u89c4\u5219\u4f1a\u4f7f\u7528\u9ed8\u8ba4\u6570\u636e"),F.a.createElement("div",null,"\u5bf9\u5e94\u62ab\u9732\u65e5\u671f\u4e3a\uff1a\u301020210624\u3011\uff0c\u7528\u6700\u540e\u4e00\u4e2a-\u7684\u540e\u9762\u7684\u6240\u6709\u6587\u5b57\uff0c\u4e0d\u6ee1\u8db3\u89c4\u5219\u4f1a\u4f7f\u7528\u9ed8\u8ba4\u6570\u636e")));return F.a.createElement(g["a"],{width:"800px",title:"\u6279\u91cf\u65b0\u589e",centered:!0,maskClosable:!1,visible:n,onCancel:l,footer:null},F.a.createElement(U["a"],{spinning:!!a},F.a.createElement(q["a"],{description:s,message:"\u6279\u91cf\u4e0a\u4f20\uff0c\u4ea7\u54c1\u540d\u79f0\u3001\u62ab\u9732\u65e5\u671f\u3001\u6587\u4ef6\u540d\u79f0\u89e3\u6790\u89c4\u5219\uff1a",type:"warning",showIcon:!0,style:{marginBottom:10}}),F.a.createElement(w["a"],{ref:this.searchFormRef,onFinish:this.onFinish,onFieldsChange:this.onFieldsChange,initialValues:{fileAuthority:[3],isNeedOverprint:0}},this.props.showProduct?F.a.createElement(_["b"],{params:"productId",value:"productId",label:"productName",formLabel:"\u9ed8\u8ba4\u4ea7\u54c1",formItemLayout:Z,extra:"\u5f53\u6587\u4ef6\u540d\u79f0\u65e0\u6cd5\u89e3\u6790\u51fa\u4ea7\u54c1\u540d\u79f0\u65f6\u7684\u9ed8\u8ba4\u503c\u3002\u5982\u4e0d\u586b\u5199\uff0c\u51fa\u73b0\u65e0\u6cd5\u89e3\u6790\u65f6\u5c06\u63d0\u9192\u60a8\uff1b\u5982\u586b\u5199\uff0c\u51fa\u73b0\u65e0\u6cd5\u89e3\u6790\u5c31\u7528\u8fd9\u4e2a\u9ed8\u8ba4\u503c"}):null,F.a.createElement(W,Object(Y["a"])({},Z,{label:"\u9ed8\u8ba4\u62ab\u9732\u65e5\u671f",name:"publishTime",extra:"\u5f53\u6587\u4ef6\u540d\u79f0\u65e0\u6cd5\u89e3\u6790\u51fa\u62ab\u9732\u65e5\u671f\u65f6\u7684\u9ed8\u8ba4\u503c\u3002\u5982\u4e0d\u586b\u5199\uff0c\u51fa\u73b0\u65e0\u6cd5\u89e3\u6790\u65f6\u5c06\u63d0\u9192\u60a8\uff1b\u5982\u586b\u5199\uff0c\u51fa\u73b0\u65e0\u6cd5\u89e3\u6790\u5c31\u7528\u8fd9\u4e2a\u9ed8\u8ba4\u503c"}),F.a.createElement(o["a"],{placeholder:"\u8bf7\u9009\u62e9\u62ab\u9732\u65f6\u95f4",style:{width:"100%"},format:G,showTime:{format:"HH:mm"}})),F.a.createElement(W,Object(Y["a"])({},Z,{label:"\u6587\u4ef6\u7c7b\u578b",name:"documentType",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6587\u4ef6\u7c7b\u578b"}],extra:"\u6587\u4ef6\u7c7b\u578b\u6709\u52df\u96c6\u6587\u4ef6\u3001\u7b7e\u7ea6\u6587\u4ef6\u3001\u62ab\u9732\u6587\u4ef6"}),F.a.createElement(I["a"],{placeholder:"\u8bf7\u9009\u62e9\u6587\u4ef6\u7c7b\u578b",allowClear:!0},C["db"].map((function(e,t){return F.a.createElement(Q,{key:t,value:e.value},e.label)})))),F.a.createElement(W,Object(Y["a"])({},Z,{label:"\u6587\u4ef6\u6743\u9650",name:"fileAuthority",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6587\u4ef6\u6743\u9650"}],extra:"\u6587\u4ef6\u6743\u9650\u6709\uff1a\u6301\u6709\u4eba\u53ef\u89c1\uff0c\u5408\u89c4\u6295\u8d44\u8005\u53ef\u89c1\uff0c\u98ce\u9669\u6d4b\u8bc4\u5ba2\u6237\u53ef\u89c1"}),F.a.createElement(I["a"],{placeholder:"\u8bf7\u9009\u62e9",mode:"multiple",allowClear:!0},C["cb"].map((function(e){return F.a.createElement(Q,{key:Object(S["q"])(5),value:e.value},e.label)})))),F.a.createElement(W,Object(Y["a"])({},Z,{label:"\u6587\u4ef6\u4e0a\u4f20",name:"file",rules:[{required:!(c.length>0),message:"\u8bf7\u4e0a\u4f20\u6587\u4ef6"}],extra:"\u8bf7\u4e0a\u4f20ZIP\u6587\u4ef6"}),F.a.createElement(H["a"],{name:"file",headers:{tokenId:Object(S["l"])("vipAdminToken")},accept:".zip",beforeUpload:this.beforeUpload,fileList:c,onRemove:this.onRemove,showUploadList:this.props.authExport,disabled:!this.props.authEdit},F.a.createElement(i["a"],{disabled:!this.props.authEdit},F.a.createElement(z["a"],null)," \u4e0a\u4f20\u6587\u4ef6"))),F.a.createElement(W,Object(Y["a"])({},X,{style:{marginTop:32}}),this.props.authEdit&&F.a.createElement(i["a"],{type:"primary",htmlType:"submit",loading:a,onClick:function(){e.setState({save:1})},style:{marginLeft:8,marginRight:8}},"\u786e\u5b9a"),F.a.createElement(i["a"],{onClick:l},"\u53d6\u6d88")))))}}]),a}(O["Component"]),ee=Object(y["b"])((function(e){var t=e.productNoticeBatch,a=e.loading;return{productNoticeBatch:t,loading:a.effects["productNoticeBatch/productFileUpload"]}}))($),te=function(e,t,a,n,l){v["default"][e||"info"]({message:t,description:a,placement:n,duration:l||3})},ae=(I["a"].Option,w["a"].Item),ne=g["a"].confirm,le=sessionStorage.getItem("PERMISSION")&&JSON.parse(sessionStorage.getItem("PERMISSION"))["30103"]||{},re=le.authEdit,ce=le.authExport,ie="YYYY/MM/DD HH:mm:ss",oe=function(e){Object(b["a"])(a,e);var t=Object(E["a"])(a);function a(){var e;Object(p["a"])(this,a);for(var h=arguments.length,b=new Array(h),E=0;E<h;E++)b[E]=arguments[E];return e=t.call.apply(t,[this].concat(b)),e.state={datasources:{},powerInfo:{},pageData:{pageNum:1,pageSize:20},selectedRowKeys:[],isModalVisible:!1,isAddOrEdit:"add",productFileId:0,announcementModalFlag:!1,batchVisible:!1,productId:""},e.searchFormRef=F.a.createRef(),e.columns=[{title:"\u4ea7\u54c1\u540d\u79f0",dataIndex:"productName",render:function(e,t){return F.a.createElement("a",{onClick:function(){return y["c"].push("/product/list/details/".concat(t.productId))}},e||"--")},width:100},{title:"\u6587\u4ef6\u540d\u79f0",dataIndex:"documentName",render:function(t,a){return F.a.createElement("a",{onClick:function(){return e._handleEdit(a)}},t||"--")},width:100},{title:F.a.createElement("span",null,F.a.createElement(m["a"],{placement:"top",title:"\u9ed8\u8ba4\u4f1a\u8bfb\u53d6\u6bcd\u57fa\u91d1\u7684\u6240\u6709\u6587\u4ef6"},F.a.createElement(N["a"],null)),"\xa0\u6bcd\u57fa\u91d1\u6587\u4ef6"),dataIndex:"isParentFund",render:function(e){return F.a.createElement("span",null,e||"--")},width:110},{title:"\u6587\u4ef6\u7c7b\u578b",dataIndex:"documentType",render:function(e){return F.a.createElement("span",null,e&&C["t"].find((function(t){return t.value===e})).label||"--")},width:120},{title:"\u6587\u4ef6\u6743\u9650",dataIndex:"fileAuthority",width:150,render:function(e){if(!Object(D["isEmpty"])(e)){var t="";return e.forEach((function(e){t="".concat(t).concat(C["cb"][e-1].label,"\uff0c")})),F.a.createElement("span",null,t.substring(0,t.length-1)||"--")}}},{title:"\u53d1\u5e03\u4eba",dataIndex:"userName",render:function(e){return F.a.createElement("span",null,e||"--")},width:100},{title:"\u53d1\u5e03\u65f6\u95f4",dataIndex:"publishTime",render:function(e){return F.a.createElement("span",null,e&&R()(e).format(ie)||"--")},width:120},{title:"\u64cd\u4f5c",width:100,render:function(t,a){return F.a.createElement(O["Fragment"],null,re&&F.a.createElement("div",null,F.a.createElement("a",{onClick:function(){return e._handleEdit(a)}},"\u67e5\u770b"),F.a.createElement("a",{style:{marginLeft:8},onClick:function(){return e.deleteFile(a.productFileId)}},"\u5220\u9664"),a.attachment&&(a.attachment.signUrl?F.a.createElement("a",{href:"".concat(a.attachment.signUrl),download:a.documentName,target:"_blank"},"\xa0\xa0\u4e0b\u8f7d"):F.a.createElement("a",{href:"".concat(a.attachment.baseUrl),download:a.documentName,target:"_blank"},"\xa0\xa0\u4e0b\u8f7d"))))}}],e._handleDownload=function(e){Object(S["f"])(e)},e.deleteFile=function(t){var a=e.props.dispatch,n=Object(f["a"])(e);ne({title:"\u8bf7\u60a8\u786e\u8ba4\u662f\u5426\u5220\u9664?",icon:F.a.createElement(x["a"],null),content:"\u5220\u9664\u540e\u8be5\u6587\u4ef6\u4fe1\u606f\u4f1a\u5168\u90e8\u5220\u9664",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){a({type:"productNotice/deleteProductFile",payload:{productFileId:t},callback:function(e){if(1008===e.code)te("success","\u63d0\u793a","\u5220\u9664\u6210\u529f","topRight"),n.Interfacesearch();else{var t=e.message||e.data||"\u67e5\u8be2\u5931\u8d25\uff01";te("warning","\u63d0\u793a(\u4ee3\u7801\uff1a".concat(e.code,")"),t,"topRight")}}})},onCancel:function(){}})},e.Interfacesearch=function(){var t=e.props,a=t.dispatch,n=(t.params,e.state.pageData),l=e.searchFormRef.current.getFieldsValue();a({type:"productNotice/getProductFile",payload:Object(u["a"])(Object(u["a"])({},l),{},{publishTime:l.publishTime&&R()(l.publishTime).valueOf()},n),callback:function(t){if(1008===t.code&&t.data)e.setState({datasources:t.data});else{var a=t.message||t.data||"\u67e5\u8be2\u5931\u8d25\uff01";te("warning","\u63d0\u793a(\u4ee3\u7801\uff1a".concat(t.code,")"),a,"topRight")}}})},e.resetSearch=function(){e.searchFormRef.current.resetFields(),e.state.pageData.pageNum=1,e.Interfacesearch()},e.handerSearch=function(){e.Interfacesearch()},e._tableChange=function(t,a,n){console.log(t,a,n),e.setState({pageData:{pageNum:t.current,pageSize:t.pageSize}},(function(){e.Interfacesearch()}))},e._onSelectChange=function(t,a){console.log(t,a),e.setState({selectedRowKeys:t})},e._cleanSelectedKeys=function(){e.setState({selectedRowKeys:[]})},e._export=function(){var t=e.state.selectedRowKeys;window.location.href="".concat(window.location.origin).concat({baseUrl:"/sitvipmanager/",adminUrl:"/vip-manager",ASSSET_DOMIAN:"RESOURCE_PATH",AI:{AI_type:2},isSaas:2}.adminUrl,"/productFile/download?productFileIds=").concat(t.toString(),"&tokenId=").concat(Object(S["l"])("vipAdminToken"))},e._downloadAll=function(){var t=e.state.pageData,a=e.searchFormRef.current.getFieldsValue();Object(S["g"])({method:"post",url:"/productFile/allExport",data:Object(u["a"])(Object(u["a"])({},a),{},{publishTime:a.publishTime&&R()(a.publishTime).valueOf()},t),callback:function(e){var t=e.status;"success"===t&&te("success","\u63d0\u9192","\u4e0b\u8f7d\u6210\u529f"),"error"===t&&te("error","\u63d0\u9192","\u4e0b\u8f7d\u5931\u8d25\uff01")}})},e._handleEdit=function(t){e.setState({isAddOrEdit:"edit",productFileId:t.productFileId,isModalVisible:!0,productId:t.productId})},e._onAdd=function(){e.setState({productId:"",isModalVisible:!0,isAddOrEdit:"add"})},e.batchAdd=function(){e.setState({batchVisible:!0})},e._handleClose=function(){e.setState({isModalVisible:!1})},e.batchClose=function(){e.setState({batchVisible:!1})},e.renderForm=function(){var t=e.state,a=(t.powerInfo,t.selectedRowKeys);return F.a.createElement(w["a"],{hideRequiredMark:!0,style:{marginTop:8},ref:e.searchFormRef,onFinish:e.handerSearch},F.a.createElement(c["a"],{gutter:[20,0]},F.a.createElement(s["a"],{span:6},F.a.createElement(ae,{label:"\u6587\u4ef6\u540d\u79f0",name:"documentName"},F.a.createElement(d["a"],{placeholder:"\u8bf7\u8f93\u5165\u6587\u4ef6\u540d\u79f0",autoComplete:"off"}))),F.a.createElement(s["a"],{span:6},F.a.createElement(ae,{label:"\u53d1\u5e03\u65f6\u95f4",name:"publishTime"},F.a.createElement(o["a"],{style:{width:"100%"}}))),F.a.createElement(s["a"],{span:6},F.a.createElement(_["b"],{params:"productIds",value:"productId",label:"productName",mode:"multiple",formLabel:"\u4ea7\u54c1\u540d\u79f0"})),F.a.createElement(s["a"],{span:6,style:{textAlign:"right"}},F.a.createElement(ae,null,F.a.createElement(i["a"],{type:"primary",htmlType:"submit",loading:!1},"\u67e5\u8be2"),F.a.createElement(i["a"],{style:{marginLeft:8},onClick:e.resetSearch},"\u91cd\u7f6e")))),F.a.createElement(c["a"],{justify:"space-between"},F.a.createElement(n["b"],null,re&&F.a.createElement(i["a"],{type:"primary",icon:F.a.createElement(A["a"],null),onClick:e._onAdd},"\u65b0\u5efa"),re&&F.a.createElement(i["a"],{type:"primary",onClick:e.batchAdd},"\u6279\u91cf\u4e0a\u4f20"),ce&&F.a.createElement(l["a"],{overlay:F.a.createElement(r["a"],null,F.a.createElement(r["a"].Item,{key:"1",disabled:0===a.length,onClick:e._export},"\u4e0b\u8f7d\u9009\u4e2d"),F.a.createElement(r["a"].Item,{key:"0",onClick:e._downloadAll},"\u4e0b\u8f7d\u5168\u90e8"))},F.a.createElement(i["a"],null,"\xa0\xa0\u6279\u91cf\u4e0b\u8f7d",F.a.createElement(M["a"],null))),re&&F.a.createElement("a",{onClick:function(){return e.announcementModalSwitch(!0)}},"\u81ea\u52a8\u751f\u6210\u516c\u544a\u6587\u4ef6"))))},e.announcementModalSwitch=function(t){e.setState({announcementModalFlag:t})},e}return Object(h["a"])(a,[{key:"componentDidMount",value:function(){this.Interfacesearch()}},{key:"render",value:function(){var e=this,t=this.props,a=t.loading,n=t.params,l=this.state,r=l.datasources,c=l.productId,i=l.pageData,o=l.selectedRowKeys,s=l.isModalVisible,d=l.isAddOrEdit,u=l.productFileId,m=l.announcementModalFlag,p=l.batchVisible,h={selectedRowKeys:o,onChange:this._onSelectChange};return F.a.createElement(L["a"],{title:"\u4ea7\u54c1\u516c\u544a\u6587\u4ef6"},F.a.createElement("div",{className:j.a.container},F.a.createElement("div",{style:{marginTop:20,marginBottom:20}},this.renderForm()),F.a.createElement(V["a"],{loading:a,columns:this.columns,dataSource:r&&r.list,total:r.pageNum&&r.total,pageNum:i.pageNum,rowKey:function(e){return e.productFileId},onChange:function(t,a,n){return e._tableChange(t,a,n)},rowSelection:h,sticky:!0,scroll:{x:"100%",scrollToFirstRowOnChange:!0}}),s&&F.a.createElement(K["a"],{modalVisible:s,onCancel:this._handleClose,productFileId:u,operateType:d,authEdit:re,authExport:ce,productId:c,Interfacesearch:this.Interfacesearch,showProduct:!0}),m&&F.a.createElement(P["a"],{disabled:"1",params:n,modalFlag:m,closeModal:function(){return e.announcementModalSwitch(!1)},updatelist:function(){return e.Interfacesearch()}}),p&&F.a.createElement(ee,{modalVisible:p,onCancel:this.batchClose,productFileId:u,authEdit:re,authExport:ce,showProduct:!0,Interfacesearch:this.Interfacesearch})))}}]),a}(O["Component"]);t["default"]=Object(y["b"])((function(e){var t=e.loading;return{loading:t.effects["productNotice/getProductFile"]}}))(oe)}}]);