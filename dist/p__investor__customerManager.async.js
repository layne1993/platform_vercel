(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[38],{J3sD:function(e,a,t){"use strict";t.r(a);t("T2oS");var n=t("W9HT"),r=(t("IzEo"),t("bx4M")),s=t("0Owb"),i=(t("14J3"),t("BMrR")),u=(t("+L6B"),t("2/Rp")),l=(t("OaEy"),t("2fM7")),c=(t("sRBo"),t("kaz8")),o=t("9og8"),d=t("k1fw"),m=(t("y8nQ"),t("Vl3Y")),g=t("tJVT"),f=(t("/xke"),t("TeRw")),p=t("WmNS"),v=t.n(p),b=t("q1tI"),E=t.n(b),O=t("9kvl"),U=t("wd/R"),I=t.n(U),M=t("5yMZ"),h=t("0WZ6"),j=function(e,a,t,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3;f["default"][e||"info"]({message:a,description:t,placement:n,duration:r||3})},y={labelCol:{xs:{span:6},sm:{span:6}},wrapperCol:{xs:{span:16},sm:{span:16}}},S=function(e){var a=e.dispatch,t=e.submitLoading,f=(e.loading,m["a"].useForm()),p=Object(g["a"])(f,1),O=p[0],U=Object(b["useState"])({}),S=Object(g["a"])(U,2),k=S[0],w=S[1],A=Object(b["useState"])([]),R=Object(g["a"])(A,2),N=R[0],T=R[1],D=Object(b["useState"])(null),x=Object(g["a"])(D,2),C=x[0],F=x[1],J=Object(b["useState"])([]),V=Object(g["a"])(J,2),G=V[0],Y=V[1],L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return a.map((function(a){e.map((function(e){a===e.managerUserId?e.use=!0:e.use=!1}))})),e},_=function(e,a){var t=[];a.map((function(a){e.includes(a.managerUserId)&&t.push(a)})),Y(t)},B=function(){a({type:"CUSTOMER_MANAGER/getManagerDistributeSetting",callback:function(e){var a=e.code,t=e.data,n=void 0===t?{}:t;e.message;1008===a&&(w(n||{}),F(n.managerUserId),O.setFieldsValue(Object(d["a"])({},n)))}})},W=function(){var e=Object(o["a"])(v.a.mark((function e(){return v.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:Promise.all([Object(M["a"])({}),Object(h["k"])()]).then((function(e){var a=[],t=[];if(e[0]&&1008===e[0].code){var n=e[0].data||{};w(n||{}),F(n.managerUserId),O.setFieldsValue(Object(d["a"])({},n)),a=n.takeManagerUsers}if(e[1]&&1008===e[1].code){var r=e[1].data||{};T(r),t=r}_(a,t)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(b["useEffect"])((function(){W()}),[]);var q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=[];return 0===e.length||a.map((function(a){e.includes(a.managerUserId)&&t.push(a.managerUserId)})),JSON.stringify(t)},z=function(e){a({type:"CUSTOMER_MANAGER/saveManagerDistributeSetting",payload:Object(d["a"])(Object(d["a"])(Object(d["a"])({},k),e),{},{distributeScene:JSON.stringify(e.distributeScene||[]),takeManagerUsers:q(e.takeManagerUsers,N)}),callback:function(e){var a=e.code,t=e.data,n=e.message;if(1008===a){var r=n||t||"\u4fdd\u5b58\u6210\u529f";j("success","\u63d0\u9192",r),B()}else{var s=n||t||"\u4fdd\u5b58\u5931\u8d25";j("error","\u63d0\u9192",s)}}})},P=function(e){var a=L(N,e),t=O.getFieldsValue(),n=t.managerUserId,r=t.takeManagerUsers;if(_(e,a),0===r.length)return F(void 0),void O.setFieldsValue({managerUserId:void 0});if(Array(e)&&!e.includes(n)){var s=[],i=-1,u=0;a.map((function(e,a){e.managerUserId===C&&(i=a),i>-1&&0===u&&e.use&&(u=e.managerUserId),e.use&&s.push(e)})),0===u&&s.length>0&&(u=s[0].managerUserId),0===u&&(u=void 0),F(u),O.setFieldsValue({managerUserId:u})}},Z=k.prevDistributeLog;return E.a.createElement(n["a"],{spinning:!1},E.a.createElement(r["a"],null,E.a.createElement(m["a"],Object(s["a"])({form:O,onFinish:z},y),E.a.createElement(m["a"].Item,{label:"\u81ea\u52a8\u5206\u914d\u5ba2\u6237\u7ecf\u7406\u7684\u73af\u8282",name:"distributeScene",extra:"\u53ef\u4ee5\u591a\u9009\uff0c\u6216\u8005\u4e0d\u9009\uff0c\u4e0d\u9009\u90a3\u4e48\u4e0d\u4f1a\u89e6\u53d1\u81ea\u52a8\u5206\u914d"},E.a.createElement(c["a"].Group,null,E.a.createElement(c["a"],{value:1},"\u6295\u8d44\u8005\u63d0\u4ea4\u5408\u683c\u6295\u8d44\u8005\u5ba1\u6838"),E.a.createElement(c["a"],{value:2},"\u6295\u8d44\u8005\u63d0\u4ea4\u4ea7\u54c1\u9884\u7ea6"))),E.a.createElement(m["a"].Item,{label:"\u53c2\u4e0e\u5ba2\u6237\u7ecf\u7406\u81ea\u52a8\u5206\u914d\u7684\u6709",name:"takeManagerUsers",extra:"\u53c2\u4e0e\u5206\u914d\u7684\u5ba2\u6237\u7ecf\u7406\uff0c\u5c06\u5728\u6709\u6295\u8d44\u8005\u9884\u7ea6\u65f6\uff0c\u5982\u679c\u8fd9\u4e2a\u6295\u8d44\u8005\u6ca1\u6709\u5bf9\u5e94\u7684\u5ba2\u6237\u7ecf\u7406\u7684\u60c5\u51b5\u4e0b\uff0c\u5c06\u6309\u7167\u6392\u961f\u5206\u914d\u4e00\u4e2a\u5ba2\u6237\u7ecf\u7406"},E.a.createElement(c["a"].Group,{onChange:P},Array.isArray(N)&&N.map((function(e){return E.a.createElement(c["a"],{key:e.managerUserId,value:e.managerUserId},e.userName)})))),E.a.createElement(m["a"].Item,{label:"\u4e0a\u4e00\u4e2a\u5ba2\u6237\u5206\u914d\u7ed9"},Z?E.a.createElement("span",null,null===Z||void 0===Z?void 0:Z.managerUserName,"\uff0c\u5206\u914d\u5ba2\u6237\u4e3a\uff1a",null===Z||void 0===Z?void 0:Z.customerName,"\uff0c\u5206\u914d\u65f6\u95f4\uff1a",(null===Z||void 0===Z?void 0:Z.updateTime)&&I()(null===Z||void 0===Z?void 0:Z.updateTime).format("YYYYMMDD")):"--"),E.a.createElement(m["a"].Item,{label:"\u4e0b\u4e00\u4e2a\u5ba2\u6237\u5206\u914d\u7ed9",name:"managerUserId",rules:[{required:!1,message:"\u8bf7\u9009\u62e9"}]},E.a.createElement(l["a"],null,Array.isArray(G)&&G.map((function(e){return E.a.createElement(l["a"].Option,{key:e.managerUserId,value:e.managerUserId},e.userName)})))),E.a.createElement(i["a"],{justify:"center"},E.a.createElement(u["a"],{type:"primary",htmlType:"submit",loading:t},"\u4fdd\u5b58")))))};a["default"]=Object(O["b"])((function(e){var a=e.loading;return{loading:a.effects["CUSTOMER_MANAGER/getManagerDistributeSetting"],submitLoading:a.effects["CUSTOMER_MANAGER/saveManagerDistributeSetting"]}}))(S),S.defaultProps={params:{},authEdit:!1}}}]);