(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[20],{DnH1:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,o,i=a("bx4M"),r=a("fWQN"),l=a("mtLc"),s=a("yKVA"),c=a("879j"),p=a("q1tI"),u=a.n(p),d=a("Hx5s"),g=a("FRQA"),m=a("MuWt"),h=a.n(m),E=(a("2qtc"),a("kLXV")),b=(a("g9YV"),a("wCAj")),f=(a("DYRE"),a("zeV3")),C=(a("+L6B"),a("2/Rp")),v=(a("14J3"),a("BMrR")),y=(a("jCWc"),a("kPKH")),S=(a("y8nQ"),a("Vl3Y")),M=(a("/xke"),a("TeRw")),O=(a("5NDa"),a("5rEg")),R=a("Qrg1"),k=a.n(R),N=a("9kvl"),I=a("LvDl"),w=a("+n12"),D=a("yEr3"),T=a.n(D),L=(a("Lzxq"),O["a"].TextArea,function(e,t,a,n,o){M["default"][e||"info"]({message:t,description:a,placement:n,duration:o||3})}),_=[{title:"\u4ea7\u54c1\u540d\u79f0",dataIndex:"productFullName"}],z=(n=Object(N["b"])((function(e){var t=e.DOUBLE_RECORD,a=e.loading;return{DOUBLE_RECORD:t,loading:a.effects["DOUBLE_RECORD/crateOrUpdateTemplate"]}})),n(o=function(e){Object(s["a"])(a,e);var t=Object(c["a"])(a);function a(){var e;Object(r["a"])(this,a);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),e.state={radioValue:0,isPublish:!1,modalFlag:!1,productList:[],isSave:!1,isPublishLoading:!1,personalMatching:T.a.createEditorState(null),personalNoMatching:T.a.createEditorState(null),organizationMatching:T.a.createEditorState(null),organizationNoMatching:T.a.createEditorState(null)},e.submitContent=function(e){return e.toHTML()},e.handleEditorChange=function(t,a){1===a?e.setState({personalMatching:t}):2===a?e.setState({personalNoMatching:t}):3===a?e.setState({organizationMatching:t}):4===a&&e.setState({organizationNoMatching:t})},e.formRef=u.a.createRef(),e._searchVersion=function(){var t=e.props.dispatch;t({type:"DOUBLE_RECORD/maxVersion",payload:{doubleType:"1"},callback:function(t){1008===t.code&&t.data&&e.formRef.current.setFieldsValue({version:t.data})}})},e.getInfluenceProductList=function(){var t=e.props.dispatch;t({type:"DOUBLE_RECORD/influenceProductList",payload:{doubleType:1},callback:function(t){var a=t.data,n=void 0===a?[]:a,o=t.code,i=t.message;if(1008===o)n.length?e.setState({productList:n,modalFlag:!0}):e._onSave("1");else{var r=i||"\u83b7\u53d6\u53d7\u5f71\u54cd\u7684\u4ea7\u54c1\u5931\u8d25\uff01";L("error","\u63d0\u9192",r)}}})},e._searchTemplate=function(t,a){var n=e.props.dispatch,o="";o="edit"===t?"templateInfo":"editIngTemplateInfo",n({type:"DOUBLE_RECORD/".concat(o),payload:{templateCode:"edit"===t?a:void 0,doubleType:1},callback:function(t){var a=t.data,n=t.code;1008===n&&t.data&&(a.template?(1===a.template.publishStatus&&e.setState({isPublish:!0}),e.setState({organizationMatching:!Object(I["isEmpty"])(a.organizationMatching)&&T.a.createEditorState(a.organizationMatching[0].questionContent),organizationNoMatching:!Object(I["isEmpty"])(a.organizationNoMatching)&&T.a.createEditorState(a.organizationNoMatching[0].questionContent),personalMatching:!Object(I["isEmpty"])(a.personalMatching)&&T.a.createEditorState(a.personalMatching[0].questionContent),personalNoMatching:!Object(I["isEmpty"])(a.personalNoMatching)&&T.a.createEditorState(a.personalNoMatching[0].questionContent)}),e.formRef.current.setFieldsValue({version:a.template&&a.template.versionNumber})):e._searchVersion())}})},e._onSave=function(t){var a=e.formRef.current.getFieldsValue(),n=a.version,o=e.state,i=o.organizationMatching,r=o.organizationNoMatching,l=o.personalMatching,s=o.personalNoMatching,c=[],p=[],u=[],d=[];if("<p></p>"!==e.submitContent(l))if("<p></p>"!==e.submitContent(s))if("<p></p>"!==e.submitContent(i))if("<p></p>"!==e.submitContent(r)){c.push({questionContent:e.submitContent(i),answerContent:"\u662f"}),p.push({questionContent:e.submitContent(r),answerContent:"\u662f"}),u.push({questionContent:e.submitContent(l),answerContent:"\u662f"}),d.push({questionContent:e.submitContent(s),answerContent:"\u662f"});var g="";"0"===t?(g="\u4fdd\u5b58",e.setState({isSave:!0})):(g="\u53d1\u5e03",e.setState({isPublishLoading:!0}));var m=e.props.dispatch;m({type:"DOUBLE_RECORD/crateOrUpdateTemplate",payload:{personalMatching:u,personalNoMatching:d,organizationMatching:c,organizationNoMatching:p,doubleType:"1",publishStatus:t,riskType:"1",version:n},callback:function(a){if(1008===a.code&&a.data)L("success","\u63d0\u793a","".concat(g,"\u6210\u529f"),"topRight"),"1"===t?(e.setState({isPublishLoading:!1}),N["c"].push({pathname:"/raisingInfo/doubleRecordConfig/generalDoubleDetails/".concat(a.data.sysWordId)}),e.closeModal()):"0"===t&&(e.setState({isSave:!1}),N["c"].push({pathname:"/raisingInfo/doubleRecordConfig/generalDoubleDetails/".concat(a.data.sysWordId)}),e.closeModal());else{var n=a.message||a.data||"".concat(g,"\u5931\u8d25");L("warning","\u63d0\u793a(\u4ee3\u7801\uff1a".concat(a.code,")"),n,"topRight")}}})}else L("warning","\u63d0\u793a","\u673a\u6784\u6295\u8d44\u8005\u98ce\u9669\u4e0d\u5339\u914d\u8bdd\u672f\u4fe1\u606f\u4e0d\u80fd\u4e3a\u7a7a","topRight");else L("warning","\u63d0\u793a","\u673a\u6784\u6295\u8d44\u8005\u98ce\u9669\u5339\u914d\u8bdd\u672f\u4fe1\u606f\u4e0d\u80fd\u4e3a\u7a7a","topRight");else L("warning","\u63d0\u793a","\u4e2a\u4eba\u6295\u8d44\u8005\u98ce\u9669\u4e0d\u5339\u914d\u8bdd\u672f\u4fe1\u606f\u4e0d\u80fd\u4e3a\u7a7a","topRight");else L("warning","\u63d0\u793a","\u4e2a\u4eba\u6295\u8d44\u8005\u98ce\u9669\u5339\u914d\u8bdd\u672f\u4fe1\u606f\u4e0d\u80fd\u4e3a\u7a7a","topRight")},e._onRadioValue=function(t){e.setState({radioValue:t.target.value})},e._handleGoBack=function(){N["c"].goBack()},e.closeModal=function(){e.setState({modalFlag:!1})},e.templateDownload=function(){window.location.href="".concat({baseUrl:"/sitvipmanager/",adminUrl:"/vip-manager",ASSSET_DOMIAN:"RESOURCE_PATH",AI:{AI_type:2},isSaas:2}.adminUrl,"/attachments/downloadFile","?source=",105,"&codeType=",1100,"&tokenId=").concat(Object(w["l"])("vipAdminToken"))},e}return Object(l["a"])(a,[{key:"componentDidMount",value:function(){var e=this.props.params;"0"===e.id?this._searchTemplate("add"):this._searchTemplate("edit",e.id)}},{key:"render",value:function(){var e=this,t=this.state,a=t.isPublishLoading,n=t.isSave,o=t.isPublish,r=t.modalFlag,l=t.productList,s=t.personalMatching,c=t.personalNoMatching,p=t.organizationMatching,d=t.organizationNoMatching,g=this.props.loading,m=sessionStorage.getItem("PERMISSION")&&JSON.parse(sessionStorage.getItem("PERMISSION"))["60200"]||{},h=m.authEdit,M=m.authExport;return u.a.createElement("div",{className:k.a.container},u.a.createElement(S["a"],{onFinish:this._onFinish,autoComplete:"off",ref:this.formRef,initialValues:{isUpdate:0}},u.a.createElement(i["a"],{title:"\u57fa\u672c\u4fe1\u606f"},u.a.createElement(S["a"].Item,{name:"version",labelCol:{span:8},wrapperCol:{span:8},label:"\u7cfb\u7edf\u53cc\u5f55\u7248\u672c\u53f7",extra:"\u7248\u672c\u540d\u79f0\u81ea\u52a8\u751f\u6210\uff0c\u6bcf\u6b21\u81ea\u52a8\u52a01"},u.a.createElement(O["a"],{disabled:!0}))),u.a.createElement(i["a"],{title:u.a.createElement("p",null,"\u8bdd\u672f\u4fe1\u606f ",M&&u.a.createElement("a",{onClick:this.templateDownload},"\u70b9\u51fb\u67e5\u770b\u652f\u6301\u901a\u914d\u7b26\u4fe1\u606f")),className:k.a.scriptInformation},u.a.createElement(v["a"],null,u.a.createElement(y["a"],{span:11},u.a.createElement("p",null,"\u4e2a\u4eba\u6295\u8d44\u8005\u98ce\u9669\u5339\u914d\uff1a"),u.a.createElement("div",null,u.a.createElement(T.a,{value:s,onChange:function(t){return e.handleEditorChange(t,1)},onSave:this.submitContent,readOnly:o,controls:[]}))),u.a.createElement(y["a"],{span:11},u.a.createElement("p",null,"\u4e2a\u4eba\u6295\u8d44\u8005\u98ce\u9669\u4e0d\u5339\u914d\uff1a"),u.a.createElement("div",null,u.a.createElement(T.a,{value:c,onChange:function(t){return e.handleEditorChange(t,2)},onSave:this.submitContent,readOnly:o,controls:[]})))),u.a.createElement(v["a"],null,u.a.createElement(y["a"],{span:11},u.a.createElement("p",{style:{marginTop:14}},"\u673a\u6784\u6295\u8d44\u8005\u98ce\u9669\u5339\u914d\uff1a"),u.a.createElement("div",null,u.a.createElement(T.a,{value:p,onChange:function(t){return e.handleEditorChange(t,3)},onSave:this.submitContent,readOnly:o,controls:[]}))),u.a.createElement(y["a"],{span:11},u.a.createElement("p",{style:{marginTop:14}},"\u673a\u6784\u6295\u8d44\u8005\u98ce\u9669\u4e0d\u5339\u914d\uff1a"),u.a.createElement("div",null,u.a.createElement(T.a,{value:d,onChange:function(t){return e.handleEditorChange(t,4)},onSave:this.submitContent,readOnly:o,controls:[]}))))),!o&&h&&u.a.createElement(S["a"].Item,{wrapperCol:24,style:{marginTop:32,textAlign:"center"}},u.a.createElement(f["b"],null,u.a.createElement(C["a"],{onClick:this._handleGoBack},"\u53d6\u6d88"),u.a.createElement(C["a"],{type:"primary",loading:g&&n,onClick:function(){return e._onSave("0")}},"\u4fdd\u5b58"),u.a.createElement(C["a"],{type:"primary",loading:g&&a&&!r,onClick:function(){return e.getInfluenceProductList()}},"\u53d1\u5e03"),u.a.createElement("span",{className:k.a.note},"\u4fdd\u5b58\u540e\u5141\u8bb8\u518d\u6b21\u7f16\u8f91\uff0c\u53d1\u5e03\u540e\u4e0d\u53ef\u4ee5\u7f16\u8f91")))),u.a.createElement(E["a"],{title:"\u7cfb\u7edf\u53cc\u5f55\u6a21\u677f\u4fee\u6539",visible:r,onCancel:this.closeModal,maskClosable:!1,footer:[u.a.createElement(C["a"],{key:"back",onClick:this.closeModal}," \u53d6\u6d88"),u.a.createElement(C["a"],{key:"submit",type:"primary",onClick:function(){return e._onSave("1")},loading:g},"\u4fdd\u5b58")]},u.a.createElement("p",null,"\u70b9\u51fb\u4fdd\u5b58\u540e\uff0c\u7cfb\u7edf\u53cc\u5f55\u6a21\u677f\u5185\u5bb9\u4f1a\u53d8\u66f4\u4e3a\u65b0\u5185\u5bb9\uff0c\u4f7f\u7528\u8be5\u6a21\u677f\u7684\u4ea7\u54c1\u4ea7\u54c1\u53cc\u5f55\u6a21\u677f\u5c06\u4e00\u8d77\u66f4\u65b0\uff0c\u8bf7\u60a8\u786e\u8ba4\u662f\u5426\u4fdd\u5b58\u3002"),u.a.createElement(b["a"],{columns:_,rowKey:"productId",dataSource:l,scroll:{x:"100%",y:240}})))}}]),a}(p["PureComponent"]))||o),j=z,P=function(e){Object(s["a"])(a,e);var t=Object(c["a"])(a);function a(){var e;Object(r["a"])(this,a);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),e.state={operationKey:"tab1"},e.onOperationTabChange=function(t){e.setState({operationKey:t})},e}return Object(l["a"])(a,[{key:"render",value:function(){var e=this.state.operationKey,t=this.props.match.params,a={tab1:u.a.createElement(j,{params:t})};return u.a.createElement(d["a"],{title:"\u53cc\u5f55\u8be6\u60c5",className:h.a.pageHeader},u.a.createElement("div",{className:h.a.main},u.a.createElement(g["a"],null,u.a.createElement(i["a"],{bordered:!1,tabList:a,onTabChange:this.onOperationTabChange,activeTabKey:e},a[e]))))}}]),a}(p["PureComponent"]);t["default"]=P},MuWt:function(e,t,a){e.exports={pageHeader:"antd-pro-pages-double-record-config-details-general-double-details-style-pageHeader"}},Qrg1:function(e,t,a){e.exports={container:"antd-pro-pages-double-record-config-details-general-double-details-components-tab1-container",scriptInformation:"antd-pro-pages-double-record-config-details-general-double-details-components-tab1-scriptInformation",note:"antd-pro-pages-double-record-config-details-general-double-details-components-tab1-note"}}}]);