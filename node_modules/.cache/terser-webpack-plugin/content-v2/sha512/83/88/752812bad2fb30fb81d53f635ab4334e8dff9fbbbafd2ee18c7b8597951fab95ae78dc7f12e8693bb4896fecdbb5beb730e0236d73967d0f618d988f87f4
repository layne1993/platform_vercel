{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[39],{J3sD:function(e,a,t){\"use strict\";t.r(a);t(\"T2oS\");var n=t(\"W9HT\"),r=(t(\"IzEo\"),t(\"bx4M\")),s=t(\"0Owb\"),i=(t(\"14J3\"),t(\"BMrR\")),u=(t(\"+L6B\"),t(\"2/Rp\")),l=(t(\"OaEy\"),t(\"2fM7\")),c=(t(\"sRBo\"),t(\"kaz8\")),o=t(\"9og8\"),m=t(\"k1fw\"),d=(t(\"y8nQ\"),t(\"Vl3Y\")),g=t(\"tJVT\"),f=(t(\"/xke\"),t(\"TeRw\")),p=t(\"WmNS\"),v=t.n(p),b=t(\"q1tI\"),E=t.n(b),O=t(\"9kvl\"),U=t(\"wd/R\"),I=t.n(U),M=t(\"5yMZ\"),h=t(\"0WZ6\"),j=function(e,a,t,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3;f[\"default\"][e||\"info\"]({message:a,description:t,placement:n,duration:r||3})},y={labelCol:{xs:{span:6},sm:{span:6}},wrapperCol:{xs:{span:16},sm:{span:16}}},S=function(e){var a=e.dispatch,t=e.submitLoading,f=(e.loading,d[\"a\"].useForm()),p=Object(g[\"a\"])(f,1),O=p[0],U=Object(b[\"useState\"])({}),S=Object(g[\"a\"])(U,2),k=S[0],w=S[1],A=Object(b[\"useState\"])([]),R=Object(g[\"a\"])(A,2),N=R[0],T=R[1],D=Object(b[\"useState\"])(null),x=Object(g[\"a\"])(D,2),C=x[0],F=x[1],J=Object(b[\"useState\"])([]),V=Object(g[\"a\"])(J,2),G=V[0],Y=V[1],L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return a.map((function(a){e.map((function(e){a===e.managerUserId?e.use=!0:e.use=!1}))})),e},_=function(e,a){var t=[];a.map((function(a){e.includes(a.managerUserId)&&t.push(a)})),Y(t)},B=function(){a({type:\"CUSTOMER_MANAGER/getManagerDistributeSetting\",callback:function(e){var a=e.code,t=e.data,n=void 0===t?{}:t;e.message;1008===a&&(w(n||{}),F(n.managerUserId),O.setFieldsValue(Object(m[\"a\"])({},n)))}})},W=function(){var e=Object(o[\"a\"])(v.a.mark((function e(){return v.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:Promise.all([Object(M[\"a\"])({}),Object(h[\"m\"])()]).then((function(e){var a=[],t=[];if(e[0]&&1008===e[0].code){var n=e[0].data||{};w(n||{}),F(n.managerUserId),O.setFieldsValue(Object(m[\"a\"])({},n)),a=n.takeManagerUsers}if(e[1]&&1008===e[1].code){var r=e[1].data||{};T(r),t=r}_(a,t)}));case 1:case\"end\":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(b[\"useEffect\"])((function(){W()}),[]);var q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=[];return 0===e.length||a.map((function(a){e.includes(a.managerUserId)&&t.push(a.managerUserId)})),JSON.stringify(t)},z=function(e){a({type:\"CUSTOMER_MANAGER/saveManagerDistributeSetting\",payload:Object(m[\"a\"])(Object(m[\"a\"])(Object(m[\"a\"])({},k),e),{},{distributeScene:JSON.stringify(e.distributeScene||[]),takeManagerUsers:q(e.takeManagerUsers,N)}),callback:function(e){var a=e.code,t=e.data,n=e.message;if(1008===a){var r=n||t||\"\\u4fdd\\u5b58\\u6210\\u529f\";j(\"success\",\"\\u63d0\\u9192\",r),B()}else{var s=n||t||\"\\u4fdd\\u5b58\\u5931\\u8d25\";j(\"error\",\"\\u63d0\\u9192\",s)}}})},P=function(e){var a=L(N,e),t=O.getFieldsValue(),n=t.managerUserId,r=t.takeManagerUsers;if(_(e,a),0===r.length)return F(void 0),void O.setFieldsValue({managerUserId:void 0});if(Array(e)&&!e.includes(n)){var s=[],i=-1,u=0;a.map((function(e,a){e.managerUserId===C&&(i=a),i>-1&&0===u&&e.use&&(u=e.managerUserId),e.use&&s.push(e)})),0===u&&s.length>0&&(u=s[0].managerUserId),0===u&&(u=void 0),F(u),O.setFieldsValue({managerUserId:u})}},Z=k.prevDistributeLog;return E.a.createElement(n[\"a\"],{spinning:!1},E.a.createElement(r[\"a\"],null,E.a.createElement(d[\"a\"],Object(s[\"a\"])({form:O,onFinish:z},y),E.a.createElement(d[\"a\"].Item,{label:\"\\u81ea\\u52a8\\u5206\\u914d\\u5ba2\\u6237\\u7ecf\\u7406\\u7684\\u73af\\u8282\",name:\"distributeScene\",extra:\"\\u53ef\\u4ee5\\u591a\\u9009\\uff0c\\u6216\\u8005\\u4e0d\\u9009\\uff0c\\u4e0d\\u9009\\u90a3\\u4e48\\u4e0d\\u4f1a\\u89e6\\u53d1\\u81ea\\u52a8\\u5206\\u914d\"},E.a.createElement(c[\"a\"].Group,null,E.a.createElement(c[\"a\"],{value:1},\"\\u6295\\u8d44\\u8005\\u63d0\\u4ea4\\u5408\\u683c\\u6295\\u8d44\\u8005\\u5ba1\\u6838\"),E.a.createElement(c[\"a\"],{value:2},\"\\u6295\\u8d44\\u8005\\u63d0\\u4ea4\\u4ea7\\u54c1\\u9884\\u7ea6\"))),E.a.createElement(d[\"a\"].Item,{label:\"\\u53c2\\u4e0e\\u5ba2\\u6237\\u7ecf\\u7406\\u81ea\\u52a8\\u5206\\u914d\\u7684\\u6709\",name:\"takeManagerUsers\",extra:\"\\u53c2\\u4e0e\\u5206\\u914d\\u7684\\u5ba2\\u6237\\u7ecf\\u7406\\uff0c\\u5c06\\u5728\\u6709\\u6295\\u8d44\\u8005\\u9884\\u7ea6\\u65f6\\uff0c\\u5982\\u679c\\u8fd9\\u4e2a\\u6295\\u8d44\\u8005\\u6ca1\\u6709\\u5bf9\\u5e94\\u7684\\u5ba2\\u6237\\u7ecf\\u7406\\u7684\\u60c5\\u51b5\\u4e0b\\uff0c\\u5c06\\u6309\\u7167\\u6392\\u961f\\u5206\\u914d\\u4e00\\u4e2a\\u5ba2\\u6237\\u7ecf\\u7406\"},E.a.createElement(c[\"a\"].Group,{onChange:P},Array.isArray(N)&&N.map((function(e){return E.a.createElement(c[\"a\"],{key:e.managerUserId,value:e.managerUserId},e.userName)})))),E.a.createElement(d[\"a\"].Item,{label:\"\\u4e0a\\u4e00\\u4e2a\\u5ba2\\u6237\\u5206\\u914d\\u7ed9\"},Z?E.a.createElement(\"span\",null,null===Z||void 0===Z?void 0:Z.managerUserName,\"\\uff0c\\u5206\\u914d\\u5ba2\\u6237\\u4e3a\\uff1a\",null===Z||void 0===Z?void 0:Z.customerName,\"\\uff0c\\u5206\\u914d\\u65f6\\u95f4\\uff1a\",(null===Z||void 0===Z?void 0:Z.updateTime)&&I()(null===Z||void 0===Z?void 0:Z.updateTime).format(\"YYYYMMDD\")):\"--\"),E.a.createElement(d[\"a\"].Item,{label:\"\\u4e0b\\u4e00\\u4e2a\\u5ba2\\u6237\\u5206\\u914d\\u7ed9\",name:\"managerUserId\",rules:[{required:!1,message:\"\\u8bf7\\u9009\\u62e9\"}]},E.a.createElement(l[\"a\"],null,Array.isArray(G)&&G.map((function(e){return E.a.createElement(l[\"a\"].Option,{key:e.managerUserId,value:e.managerUserId},e.userName)})))),E.a.createElement(i[\"a\"],{justify:\"center\"},E.a.createElement(u[\"a\"],{type:\"primary\",htmlType:\"submit\",loading:t},\"\\u4fdd\\u5b58\")))))};a[\"default\"]=Object(O[\"b\"])((function(e){var a=e.loading;return{loading:a.effects[\"CUSTOMER_MANAGER/getManagerDistributeSetting\"],submitLoading:a.effects[\"CUSTOMER_MANAGER/saveManagerDistributeSetting\"]}}))(S),S.defaultProps={params:{},authEdit:!1}}}]);","name":"p__investor__customerManager.async.js?v=1647342498084","map":{"version":3,"sources":["p__investor__customerManager.async.js?v=1647342498084"],"names":["window","push","J3sD","module","__webpack_exports__","__webpack_require__","r","antd_es_spin__WEBPACK_IMPORTED_MODULE_1__","antd_es_card__WEBPACK_IMPORTED_MODULE_3__","E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_4__","antd_es_row__WEBPACK_IMPORTED_MODULE_6__","antd_es_button__WEBPACK_IMPORTED_MODULE_8__","antd_es_select__WEBPACK_IMPORTED_MODULE_10__","antd_es_checkbox__WEBPACK_IMPORTED_MODULE_12__","E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_13__","E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_14__","antd_es_form__WEBPACK_IMPORTED_MODULE_16__","E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_17__","antd_es_notification__WEBPACK_IMPORTED_MODULE_19__","E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_20__","E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_20___default","n","react__WEBPACK_IMPORTED_MODULE_21__","react__WEBPACK_IMPORTED_MODULE_21___default","umi__WEBPACK_IMPORTED_MODULE_22__","moment__WEBPACK_IMPORTED_MODULE_23__","moment__WEBPACK_IMPORTED_MODULE_23___default","_service__WEBPACK_IMPORTED_MODULE_24__","_services_global__WEBPACK_IMPORTED_MODULE_25__","openNotification","type","message","description","placement","duration","arguments","length","undefined","formItemLayout","labelCol","xs","span","sm","wrapperCol","Maintenance","props","dispatch","submitLoading","_Form$useForm","loading","useForm","_Form$useForm2","Object","form","_useState","_useState2","configInfo","setConfigInfo","_useState3","_useState4","managerList","setMangerList","_useState5","_useState6","currentId","setCurrentId","_useState7","_useState8","usedManagerList","setUsedManagerList","dataMixins","checkList","map","id","item","managerUserId","use","getUsedManagerList","useManagerIds","allManagerList","newArr","includes","getConfig","callback","_ref","code","_ref$data","data","setFieldsValue","getData","_ref3","a","mark","_callee","wrap","_context","prev","next","Promise","all","then","result","useManagerList","takeManagerUsers","_data","stop","apply","this","managerSort","useManager","JSON","stringify","onFinish","values","payload","distributeScene","_ref4","txt","_txt","checkboxChange","newManagerList","_form$getFieldsValue","getFieldsValue","Array","currentManagerIndex","nextManagerId","index","prevDistributeLog","createElement","spinning","Item","label","name","extra","Group","value","onChange","isArray","key","userName","managerUserName","customerName","updateTime","format","rules","required","Option","justify","htmlType","_ref5","effects","defaultProps","params","authEdit"],"mappings":"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"},"input":"(window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || []).push([[39],{\n\n/***/ \"J3sD\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var antd_es_spin_style__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"T2oS\");\n/* harmony import */ var antd_es_spin__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"W9HT\");\n/* harmony import */ var antd_es_card_style__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"IzEo\");\n/* harmony import */ var antd_es_card__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"bx4M\");\n/* harmony import */ var E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"0Owb\");\n/* harmony import */ var antd_es_row_style__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(\"14J3\");\n/* harmony import */ var antd_es_row__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(\"BMrR\");\n/* harmony import */ var antd_es_button_style__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(\"+L6B\");\n/* harmony import */ var antd_es_button__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(\"2/Rp\");\n/* harmony import */ var antd_es_select_style__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(\"OaEy\");\n/* harmony import */ var antd_es_select__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(\"2fM7\");\n/* harmony import */ var antd_es_checkbox_style__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(\"sRBo\");\n/* harmony import */ var antd_es_checkbox__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(\"kaz8\");\n/* harmony import */ var E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(\"9og8\");\n/* harmony import */ var E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(\"k1fw\");\n/* harmony import */ var antd_es_form_style__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(\"y8nQ\");\n/* harmony import */ var antd_es_form__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(\"Vl3Y\");\n/* harmony import */ var E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(\"tJVT\");\n/* harmony import */ var antd_es_notification_style__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(\"/xke\");\n/* harmony import */ var antd_es_notification__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(\"TeRw\");\n/* harmony import */ var E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(\"WmNS\");\n/* harmony import */ var E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_20___default = /*#__PURE__*/__webpack_require__.n(E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_20__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(\"q1tI\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_21___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_21__);\n/* harmony import */ var umi__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(\"9kvl\");\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(\"wd/R\");\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_23___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_23__);\n/* harmony import */ var _service__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(\"5yMZ\");\n/* harmony import */ var _services_global__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(\"0WZ6\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/*\n * @Descripttion: 客户经理管理\n * @version:\n * @Author: yezi\n * @Date: 2021-06-03 18:58:44\n * @LastEditTime: 2021-08-16 16:42:55\n */\n\n\n\n\n\n\nvar openNotification = function openNotification(type, message, description, placement) {\n  var duration = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 3;\n\n  antd_es_notification__WEBPACK_IMPORTED_MODULE_19__[\"default\"][type || 'info']({\n    message: message,\n    description: description,\n    placement: placement,\n    duration: duration || 3\n  });\n};\n\nvar formItemLayout = {\n  labelCol: {\n    xs: {\n      span: 6\n    },\n    sm: {\n      span: 6\n    }\n  },\n  wrapperCol: {\n    xs: {\n      span: 16\n    },\n    sm: {\n      span: 16\n    }\n  }\n};\n\nvar Maintenance = function Maintenance(props) {\n  var dispatch = props.dispatch,\n      submitLoading = props.submitLoading,\n      loading = props.loading;\n\n  var _Form$useForm = antd_es_form__WEBPACK_IMPORTED_MODULE_16__[/* default */ \"a\"].useForm(),\n      _Form$useForm2 = Object(E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_17__[/* default */ \"a\"])(_Form$useForm, 1),\n      form = _Form$useForm2[0];\n\n  var _useState = Object(react__WEBPACK_IMPORTED_MODULE_21__[\"useState\"])({}),\n      _useState2 = Object(E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_17__[/* default */ \"a\"])(_useState, 2),\n      configInfo = _useState2[0],\n      setConfigInfo = _useState2[1];\n\n  var _useState3 = Object(react__WEBPACK_IMPORTED_MODULE_21__[\"useState\"])([]),\n      _useState4 = Object(E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_17__[/* default */ \"a\"])(_useState3, 2),\n      managerList = _useState4[0],\n      setMangerList = _useState4[1];\n\n  var _useState5 = Object(react__WEBPACK_IMPORTED_MODULE_21__[\"useState\"])(null),\n      _useState6 = Object(E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_17__[/* default */ \"a\"])(_useState5, 2),\n      currentId = _useState6[0],\n      setCurrentId = _useState6[1];\n\n  var _useState7 = Object(react__WEBPACK_IMPORTED_MODULE_21__[\"useState\"])([]),\n      _useState8 = Object(E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_17__[/* default */ \"a\"])(_useState7, 2),\n      usedManagerList = _useState8[0],\n      setUsedManagerList = _useState8[1];\n  /**\n   * @description 数据混合\n   * @param managerList\n   * @param checkList\n   */\n\n\n  var dataMixins = function dataMixins() {\n    var managerList = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    var checkList = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n    checkList.map(function (id) {\n      managerList.map(function (item) {\n        if (id === item.managerUserId) {\n          item.use = true;\n        } else {\n          item.use = false;\n        }\n      });\n    });\n    return managerList;\n  };\n  /**\n   * @description 获取参与分配的客户经理\n   * @param useManagerIds\n   * @param allManagerList\n   */\n\n\n  var getUsedManagerList = function getUsedManagerList(useManagerIds, allManagerList) {\n    var newArr = [];\n    allManagerList.map(function (item) {\n      if (useManagerIds.includes(item.managerUserId)) {\n        newArr.push(item);\n      }\n    });\n    setUsedManagerList(newArr);\n  };\n  /**\n   * @description 查询配置信息\n   */\n\n\n  var getConfig = function getConfig() {\n    dispatch({\n      type: 'CUSTOMER_MANAGER/getManagerDistributeSetting',\n      callback: function callback(_ref) {\n        var code = _ref.code,\n            _ref$data = _ref.data,\n            data = _ref$data === void 0 ? {} : _ref$data,\n            message = _ref.message;\n\n        if (code === 1008) {\n          setConfigInfo(data || {});\n          setCurrentId(data.managerUserId);\n          form.setFieldsValue(Object(E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_14__[/* default */ \"a\"])({}, data));\n        }\n      }\n    });\n  };\n  /**\n   * @description 获取客户经理\n   */\n\n\n  var getManagerList = function getManagerList() {\n    dispatch({\n      type: 'global/selectAllAccountManager',\n      callback: function callback(_ref2) {\n        var code = _ref2.code,\n            _ref2$data = _ref2.data,\n            data = _ref2$data === void 0 ? [] : _ref2$data,\n            message = _ref2.message;\n\n        if (code === 1008) {\n          setMangerList(data);\n        }\n      }\n    });\n  }; // 获取数据\n\n\n  var getData = /*#__PURE__*/function () {\n    var _ref3 = Object(E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_13__[/* default */ \"a\"])( /*#__PURE__*/E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_20___default.a.mark(function _callee() {\n      return E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_20___default.a.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              Promise.all([Object(_service__WEBPACK_IMPORTED_MODULE_24__[/* getManagerDistributeSetting */ \"a\"])({}), Object(_services_global__WEBPACK_IMPORTED_MODULE_25__[/* selectAllAccountManager */ \"m\"])()]).then(function (result) {\n                var useManagerList = [];\n                var allManagerList = [];\n\n                if (result[0] && result[0].code === 1008) {\n                  var data = result[0].data || {};\n                  setConfigInfo(data || {});\n                  setCurrentId(data.managerUserId);\n                  form.setFieldsValue(Object(E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_14__[/* default */ \"a\"])({}, data));\n                  useManagerList = data.takeManagerUsers;\n                }\n\n                if (result[1] && result[1].code === 1008) {\n                  var _data = result[1].data || {};\n\n                  setMangerList(_data);\n                  allManagerList = _data;\n                }\n\n                getUsedManagerList(useManagerList, allManagerList);\n              });\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function getData() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  Object(react__WEBPACK_IMPORTED_MODULE_21__[\"useEffect\"])(function () {\n    getData(); // getConfig();\n    // getManagerList();\n  }, []); // 客户经理排序\n\n  var managerSort = function managerSort() {\n    var useManager = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    var managerList = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n    var newArr = [];\n    if (useManager.length === 0) return JSON.stringify(newArr);\n    managerList.map(function (item) {\n      if (useManager.includes(item.managerUserId)) {\n        newArr.push(item.managerUserId);\n      }\n    });\n    return JSON.stringify(newArr);\n  };\n  /**\n   * @description 保存\n   */\n\n\n  var onFinish = function onFinish(values) {\n    // const values = form.getFieldsValue();\n    dispatch({\n      type: 'CUSTOMER_MANAGER/saveManagerDistributeSetting',\n      payload: Object(E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_14__[/* default */ \"a\"])(Object(E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_14__[/* default */ \"a\"])(Object(E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_14__[/* default */ \"a\"])({}, configInfo), values), {}, {\n        distributeScene: JSON.stringify(values.distributeScene || []),\n        takeManagerUsers: managerSort(values.takeManagerUsers, managerList)\n      }),\n      callback: function callback(_ref4) {\n        var code = _ref4.code,\n            data = _ref4.data,\n            message = _ref4.message;\n\n        if (code === 1008) {\n          var txt = message || data || '保存成功';\n          openNotification('success', '提醒', txt);\n          getConfig();\n        } else {\n          var _txt = message || data || '保存失败';\n\n          openNotification('error', '提醒', _txt);\n        }\n      }\n    });\n  }; // checkbox change事件\n\n\n  var checkboxChange = function checkboxChange(values) {\n    var newManagerList = dataMixins(managerList, values); // console.log(newManagerList, 'newManagerList');\n\n    var _form$getFieldsValue = form.getFieldsValue(),\n        managerUserId = _form$getFieldsValue.managerUserId,\n        takeManagerUsers = _form$getFieldsValue.takeManagerUsers;\n\n    getUsedManagerList(values, newManagerList);\n\n    if (takeManagerUsers.length === 0) {\n      setCurrentId(undefined);\n      form.setFieldsValue({\n        managerUserId: undefined\n      });\n      return;\n    }\n\n    if (Array(values) && !values.includes(managerUserId)) {\n      var useManagerList = [];\n      var currentManagerIndex = -1;\n      var nextManagerId = 0;\n      newManagerList.map(function (item, index) {\n        if (item.managerUserId === currentId) {\n          currentManagerIndex = index;\n        }\n\n        if (currentManagerIndex > -1 && nextManagerId === 0 && item.use) {\n          nextManagerId = item.managerUserId;\n        }\n\n        if (item.use) {\n          useManagerList.push(item);\n        }\n      }); // console.log(nextManagerId, '---', useManagerList);\n\n      if (nextManagerId === 0 && useManagerList.length > 0) {\n        nextManagerId = useManagerList[0].managerUserId;\n      }\n\n      if (nextManagerId === 0) {\n        nextManagerId = undefined;\n      }\n\n      setCurrentId(nextManagerId);\n      form.setFieldsValue({\n        managerUserId: nextManagerId\n      });\n    }\n  };\n\n  var prevDistributeLog = configInfo.prevDistributeLog;\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(antd_es_spin__WEBPACK_IMPORTED_MODULE_1__[/* default */ \"a\"], {\n    spinning: false\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(antd_es_card__WEBPACK_IMPORTED_MODULE_3__[/* default */ \"a\"], null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(antd_es_form__WEBPACK_IMPORTED_MODULE_16__[/* default */ \"a\"], Object(E_MRP_vip_manager_node_modules_umijs_babel_preset_umi_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_4__[/* default */ \"a\"])({\n    form: form,\n    onFinish: onFinish\n  }, formItemLayout), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(antd_es_form__WEBPACK_IMPORTED_MODULE_16__[/* default */ \"a\"].Item, {\n    label: \"\\u81EA\\u52A8\\u5206\\u914D\\u5BA2\\u6237\\u7ECF\\u7406\\u7684\\u73AF\\u8282\",\n    name: \"distributeScene\",\n    extra: \"\\u53EF\\u4EE5\\u591A\\u9009\\uFF0C\\u6216\\u8005\\u4E0D\\u9009\\uFF0C\\u4E0D\\u9009\\u90A3\\u4E48\\u4E0D\\u4F1A\\u89E6\\u53D1\\u81EA\\u52A8\\u5206\\u914D\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(antd_es_checkbox__WEBPACK_IMPORTED_MODULE_12__[/* default */ \"a\"].Group, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(antd_es_checkbox__WEBPACK_IMPORTED_MODULE_12__[/* default */ \"a\"], {\n    value: 1\n  }, \"\\u6295\\u8D44\\u8005\\u63D0\\u4EA4\\u5408\\u683C\\u6295\\u8D44\\u8005\\u5BA1\\u6838\"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(antd_es_checkbox__WEBPACK_IMPORTED_MODULE_12__[/* default */ \"a\"], {\n    value: 2\n  }, \"\\u6295\\u8D44\\u8005\\u63D0\\u4EA4\\u4EA7\\u54C1\\u9884\\u7EA6\"))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(antd_es_form__WEBPACK_IMPORTED_MODULE_16__[/* default */ \"a\"].Item, {\n    label: \"\\u53C2\\u4E0E\\u5BA2\\u6237\\u7ECF\\u7406\\u81EA\\u52A8\\u5206\\u914D\\u7684\\u6709\",\n    name: \"takeManagerUsers\",\n    extra: \"\\u53C2\\u4E0E\\u5206\\u914D\\u7684\\u5BA2\\u6237\\u7ECF\\u7406\\uFF0C\\u5C06\\u5728\\u6709\\u6295\\u8D44\\u8005\\u9884\\u7EA6\\u65F6\\uFF0C\\u5982\\u679C\\u8FD9\\u4E2A\\u6295\\u8D44\\u8005\\u6CA1\\u6709\\u5BF9\\u5E94\\u7684\\u5BA2\\u6237\\u7ECF\\u7406\\u7684\\u60C5\\u51B5\\u4E0B\\uFF0C\\u5C06\\u6309\\u7167\\u6392\\u961F\\u5206\\u914D\\u4E00\\u4E2A\\u5BA2\\u6237\\u7ECF\\u7406\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(antd_es_checkbox__WEBPACK_IMPORTED_MODULE_12__[/* default */ \"a\"].Group, {\n    onChange: checkboxChange\n  }, Array.isArray(managerList) && managerList.map(function (item) {\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(antd_es_checkbox__WEBPACK_IMPORTED_MODULE_12__[/* default */ \"a\"], {\n      key: item.managerUserId,\n      value: item.managerUserId\n    }, item.userName);\n  }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(antd_es_form__WEBPACK_IMPORTED_MODULE_16__[/* default */ \"a\"].Item, {\n    label: \"\\u4E0A\\u4E00\\u4E2A\\u5BA2\\u6237\\u5206\\u914D\\u7ED9\"\n  }, prevDistributeLog ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(\"span\", null, prevDistributeLog === null || prevDistributeLog === void 0 ? void 0 : prevDistributeLog.managerUserName, \"\\uFF0C\\u5206\\u914D\\u5BA2\\u6237\\u4E3A\\uFF1A\", prevDistributeLog === null || prevDistributeLog === void 0 ? void 0 : prevDistributeLog.customerName, \"\\uFF0C\\u5206\\u914D\\u65F6\\u95F4\\uFF1A\", (prevDistributeLog === null || prevDistributeLog === void 0 ? void 0 : prevDistributeLog.updateTime) && moment__WEBPACK_IMPORTED_MODULE_23___default()(prevDistributeLog === null || prevDistributeLog === void 0 ? void 0 : prevDistributeLog.updateTime).format('YYYYMMDD')) : '--'), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(antd_es_form__WEBPACK_IMPORTED_MODULE_16__[/* default */ \"a\"].Item, {\n    label: \"\\u4E0B\\u4E00\\u4E2A\\u5BA2\\u6237\\u5206\\u914D\\u7ED9\",\n    name: \"managerUserId\",\n    rules: [{\n      required: false,\n      message: '请选择'\n    }]\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(antd_es_select__WEBPACK_IMPORTED_MODULE_10__[/* default */ \"a\"], null, Array.isArray(usedManagerList) && usedManagerList.map(function (item) {\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(antd_es_select__WEBPACK_IMPORTED_MODULE_10__[/* default */ \"a\"].Option, {\n      key: item.managerUserId,\n      value: item.managerUserId\n    }, item.userName);\n  }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(antd_es_row__WEBPACK_IMPORTED_MODULE_6__[/* default */ \"a\"], {\n    justify: \"center\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_21___default.a.createElement(antd_es_button__WEBPACK_IMPORTED_MODULE_8__[/* default */ \"a\"], {\n    type: \"primary\",\n    htmlType: \"submit\",\n    loading: submitLoading\n  }, \"\\u4FDD\\u5B58\")))));\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Object(umi__WEBPACK_IMPORTED_MODULE_22__[/* connect */ \"b\"])(function (_ref5) {\n  var loading = _ref5.loading;\n  return {\n    loading: loading.effects['CUSTOMER_MANAGER/getManagerDistributeSetting'],\n    submitLoading: loading.effects['CUSTOMER_MANAGER/saveManagerDistributeSetting']\n  };\n})(Maintenance));\nMaintenance.defaultProps = {\n  params: {},\n  authEdit: false\n};\n\n/***/ })\n\n}]);","inputSourceMap":{"version":3,"sources":["E:/公司代码/MRP报表/vip-manager/src/pages/investor/customerManager/index.tsx"],"names":["openNotification","type","message","description","placement","duration","formItemLayout","labelCol","xs","span","sm","wrapperCol","Maintenance","props","dispatch","submitLoading","loading","useForm","form","useState","configInfo","setConfigInfo","managerList","setMangerList","currentId","setCurrentId","usedManagerList","setUsedManagerList","dataMixins","checkList","map","id","item","managerUserId","use","getUsedManagerList","useManagerIds","allManagerList","newArr","includes","push","getConfig","callback","code","data","setFieldsValue","getManagerList","getData","Promise","all","getManagerDistributeSetting","selectAllAccountManager","then","result","useManagerList","takeManagerUsers","useEffect","managerSort","useManager","length","JSON","stringify","onFinish","values","payload","distributeScene","txt","checkboxChange","newManagerList","getFieldsValue","undefined","Array","currentManagerIndex","nextManagerId","index","prevDistributeLog","isArray","userName","managerUserName","customerName","updateTime","moment","format","required","connect","effects","defaultProps","params","authEdit"],"mappings":"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","file":"x","sourcesContent":["/*\n * @Descripttion: 客户经理管理\n * @version:\n * @Author: yezi\n * @Date: 2021-06-03 18:58:44\n * @LastEditTime: 2021-08-16 16:42:55\n */\n\nimport React, { useState, useEffect } from 'react';\nimport type { FC } from 'react';\nimport type { Dispatch } from 'umi';\nimport { Card, Form, Input, notification, Spin, Select, Row, Button, Checkbox } from 'antd';\nimport { connect } from 'umi';\nimport { ExclamationCircleOutlined } from '@ant-design/icons';\nimport _styles from './styles.less';\nimport moment from 'moment';\nimport { getManagerDistributeSetting } from './service';\nimport { selectAllAccountManager } from '@/services/global';\n\n\nconst openNotification = (type, message, description, placement?, duration = 3) => {\n    notification[type || 'info']({\n        message,\n        description,\n        placement,\n        duration: duration || 3\n    });\n};\n\nconst formItemLayout = {\n    labelCol: {\n        xs: { span: 6 },\n        sm: { span: 6 }\n    },\n    wrapperCol: {\n        xs: { span: 16 },\n        sm: { span: 16 }\n    }\n};\n\ninterface MaintenanceProps {\n    params: any;\n    dispatch: Dispatch;\n    success: any;\n    loading: boolean;\n    authEdit: boolean,\n    submitLoading: boolean,\n    total: number\n}\n\n\nconst Maintenance: FC<MaintenanceProps> = (props) => {\n    const { dispatch, submitLoading, loading } = props;\n    const [form] = Form.useForm();\n    const [configInfo, setConfigInfo] = useState<any>({});\n    const [managerList, setMangerList] = useState<any[]>([]);\n    const [currentId, setCurrentId] = useState<number>(null);\n    const [usedManagerList, setUsedManagerList] = useState<any[]>([]);\n\n\n    /**\n     * @description 数据混合\n     * @param managerList\n     * @param checkList\n     */\n    const dataMixins = (managerList = [], checkList = []) => {\n        checkList.map((id) => {\n            managerList.map((item) => {\n                if (id === item.managerUserId) {\n                    item.use = true;\n                } else {\n                    item.use = false;\n                }\n            });\n        });\n        return managerList;\n    };\n\n    /**\n     * @description 获取参与分配的客户经理\n     * @param useManagerIds\n     * @param allManagerList\n     */\n    const getUsedManagerList = (useManagerIds, allManagerList) => {\n        const newArr = [];\n        allManagerList.map((item) => {\n            if (useManagerIds.includes(item.managerUserId)) {\n                newArr.push(item);\n            }\n        });\n        setUsedManagerList(newArr);\n    };\n\n\n    /**\n     * @description 查询配置信息\n     */\n    const getConfig = () => {\n        dispatch({\n            type: 'CUSTOMER_MANAGER/getManagerDistributeSetting',\n            callback: ({ code, data = {}, message }) => {\n                if (code === 1008) {\n                    setConfigInfo(data || {});\n                    setCurrentId(data.managerUserId);\n                    form.setFieldsValue({\n                        ...data\n                    });\n                }\n            }\n        });\n    };\n\n    /**\n     * @description 获取客户经理\n     */\n    const getManagerList = () => {\n        dispatch({\n            type: 'global/selectAllAccountManager',\n            callback: ({ code, data = [], message }) => {\n                if (code === 1008) {\n                    setMangerList(data);\n                }\n            }\n        });\n    };\n\n\n\n    // 获取数据\n    const getData = async () => {\n        Promise.all([getManagerDistributeSetting({}), selectAllAccountManager()]).then((result) => {\n            let useManagerList = [];\n            let allManagerList = [];\n            if (result[0] && result[0].code === 1008) {\n                const data = result[0].data || {};\n                setConfigInfo(data || {});\n                setCurrentId(data.managerUserId);\n                form.setFieldsValue({\n                    ...data\n                });\n                useManagerList = data.takeManagerUsers;\n            }\n\n            if (result[1] && result[1].code === 1008) {\n                const data = result[1].data || {};\n                setMangerList(data);\n                allManagerList = data;\n            }\n\n            getUsedManagerList(useManagerList, allManagerList);\n\n        });\n    };\n\n\n    useEffect(() => {\n        getData();\n        // getConfig();\n        // getManagerList();\n    }, []);\n\n    // 客户经理排序\n    const managerSort = (useManager = [], managerList = []) => {\n        const newArr = [];\n        if (useManager.length === 0) return JSON.stringify(newArr);\n        managerList.map((item) => {\n            if (useManager.includes(item.managerUserId)) {\n                newArr.push(item.managerUserId);\n            }\n        });\n        return JSON.stringify(newArr);\n    };\n\n    /**\n     * @description 保存\n     */\n    const onFinish = (values) => {\n        // const values = form.getFieldsValue();\n        dispatch({\n            type: 'CUSTOMER_MANAGER/saveManagerDistributeSetting',\n            payload: {\n                ...configInfo,\n                ...values,\n                distributeScene: JSON.stringify(values.distributeScene || []),\n                takeManagerUsers: managerSort(values.takeManagerUsers, managerList)\n            },\n            callback: ({ code, data, message }: any) => {\n                if (code === 1008) {\n                    const txt = message || data || '保存成功';\n                    openNotification('success', '提醒', txt);\n                    getConfig();\n                } else {\n                    const txt = message || data || '保存失败';\n                    openNotification('error', '提醒', txt);\n                }\n            }\n        });\n    };\n\n    // checkbox change事件\n    const checkboxChange = (values) => {\n        const newManagerList = dataMixins(managerList, values);\n        // console.log(newManagerList, 'newManagerList');\n        const { managerUserId, takeManagerUsers } = form.getFieldsValue();\n        getUsedManagerList(values, newManagerList);\n        if (takeManagerUsers.length === 0) {\n            setCurrentId(undefined);\n            form.setFieldsValue({ managerUserId: undefined });\n            return;\n        }\n        if (Array(values) && !values.includes(managerUserId)) {\n\n            let useManagerList = [];\n            let currentManagerIndex = -1;\n            let nextManagerId = 0;\n            newManagerList.map((item, index) => {\n                if (item.managerUserId === currentId) {\n                    currentManagerIndex = index;\n                }\n                if (currentManagerIndex > -1 && nextManagerId === 0 && item.use) {\n                    nextManagerId = item.managerUserId;\n                }\n                if (item.use) {\n                    useManagerList.push(item);\n                }\n            });\n\n            // console.log(nextManagerId, '---', useManagerList);\n\n            if (nextManagerId === 0 && useManagerList.length > 0) {\n                nextManagerId = useManagerList[0].managerUserId;\n            }\n            if (nextManagerId === 0) {\n                nextManagerId = undefined;\n            }\n            setCurrentId(nextManagerId);\n            form.setFieldsValue({ managerUserId: nextManagerId });\n        }\n    };\n\n\n    const { prevDistributeLog } = configInfo;\n\n\n    return (\n        <Spin spinning={false}>\n            <Card>\n                <Form\n                    form={form}\n                    onFinish={onFinish}\n                    {...formItemLayout}\n                >\n                    <Form.Item\n                        label=\"自动分配客户经理的环节\"\n                        name=\"distributeScene\"\n                        extra=\"可以多选，或者不选，不选那么不会触发自动分配\"\n                    >\n                        <Checkbox.Group>\n                            <Checkbox value={1}>投资者提交合格投资者审核</Checkbox>\n                            <Checkbox value={2}>投资者提交产品预约</Checkbox>\n                        </Checkbox.Group>\n\n                    </Form.Item>\n\n                    <Form.Item\n                        label=\"参与客户经理自动分配的有\"\n                        name=\"takeManagerUsers\"\n                        extra=\"参与分配的客户经理，将在有投资者预约时，如果这个投资者没有对应的客户经理的情况下，将按照排队分配一个客户经理\"\n                    >\n                        <Checkbox.Group onChange={checkboxChange}>\n                            {Array.isArray(managerList) && managerList.map(((item) => (\n                                <Checkbox key={item.managerUserId} value={item.managerUserId}>{item.userName}</Checkbox>\n                            )))}\n                        </Checkbox.Group>\n\n                    </Form.Item>\n                    <Form.Item\n                        label=\"上一个客户分配给\"\n                    >\n                        {prevDistributeLog ? <span>{prevDistributeLog?.managerUserName}，分配客户为：{prevDistributeLog?.customerName}，分配时间：{prevDistributeLog?.updateTime && moment(prevDistributeLog?.updateTime).format('YYYYMMDD')}</span> : '--'}\n                    </Form.Item>\n\n                    <Form.Item\n                        label=\"下一个客户分配给\"\n                        name=\"managerUserId\"\n                        rules={[{ required: false, message: '请选择' }]}\n                    >\n                        <Select>\n                            {Array.isArray(usedManagerList) && usedManagerList.map((item) => (\n                                <Select.Option key={item.managerUserId} value={item.managerUserId}>{item.userName}</Select.Option>\n                            ))}\n                        </Select>\n                    </Form.Item>\n\n                    <Row justify=\"center\">\n                        <Button type=\"primary\" htmlType=\"submit\" loading={submitLoading}>保存</Button>\n                    </Row>\n                </Form>\n            </Card>\n        </Spin>\n    );\n};\n\n\nexport default connect(({ loading }) => ({\n    loading: loading.effects['CUSTOMER_MANAGER/getManagerDistributeSetting'],\n    submitLoading: loading.effects['CUSTOMER_MANAGER/saveManagerDistributeSetting']\n}))(Maintenance);\n\nMaintenance.defaultProps = {\n    params: {},\n    authEdit: false\n};\n"]}}